import{r as x,j as g,M as Jt,T as qt,a as mt,l as Pt,P as xt,b as Qt}from"./index.DYwFTzuw.js";import Zt from"./ClientDashboard.DuacHIMU.js";function It(e,t,i,n,r){n=n||{};var o=1.15,s=r.internal.scaleFactor,l=r.internal.getFontSize()/s,d=r.getLineHeightFactor?r.getLineHeightFactor():o,a=l*d,f=/\r\n|\r|\n/g,h="",u=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(h=typeof e=="string"?e.split(f):e,u=h.length||1),i+=l*(2-o),n.valign==="middle"?i-=u/2*a:n.valign==="bottom"&&(i-=u*a),n.halign==="center"||n.halign==="right"){var c=l;if(n.halign==="center"&&(c*=.5),h&&u>=1){for(var p=0;p<h.length;p++)r.text(h[p],t-r.getStringUnitWidth(h[p])*c,i),i+=a;return r}t-=r.getStringUnitWidth(e)*c}return n.halign==="justify"?r.text(e,t,i,{maxWidth:n.maxWidth||100,align:"justify"}):r.text(e,t,i),r}var St={},et=(function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,i){i===void 0&&(i=null),i?i.__autoTableDocumentDefaults=t:St=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,i){var n,r,o;i===void 0&&(i=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),l=s.fontStyle,d=s.fontName;if(t.font&&(d=t.font),t.fontStyle){l=t.fontStyle;var a=this.getFontList()[d];a&&a.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(a[0]),l=a[0])}if(this.jsPDFDocument.setFont(d,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!i){var f=e.unifyColor(t.fillColor);f&&(n=this.jsPDFDocument).setFillColor.apply(n,f),f=e.unifyColor(t.textColor),f&&(r=this.jsPDFDocument).setTextColor.apply(r,f),f=e.unifyColor(t.lineColor),f&&(o=this.jsPDFDocument).setDrawColor.apply(o,f),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,i,n){return this.jsPDFDocument.splitTextToSize(t,i,n)},e.prototype.rect=function(t,i,n,r,o){return this.jsPDFDocument.rect(t,i,n,r,o)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return St||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e})(),ut=function(e,t){return ut=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},ut(e,t)};function Nt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");ut(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var Rt=(function(e){Nt(t,e);function t(i){var n=e.call(this)||this;return n._element=i,n}return t})(Array);function Xt(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function te(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function rt(e,t,i){i.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],r=n.map(function(o){return i.getTextWidth(o)}).reduce(function(o,s){return Math.max(o,s)},0);return r}function Ot(e,t,i,n){var r=t.settings.tableLineWidth,o=t.settings.tableLineColor;e.applyStyles({lineWidth:r,lineColor:o});var s=Lt(r,!1);s&&e.rect(i.x,i.y,t.getWidth(e.pageSize().width),n.y-i.y,s)}function Lt(e,t){var i=e>0,n=t||t===0;return i&&n?"DF":i?"S":n?"F":null}function at(e,t){var i,n,r,o;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(i=e.left)!==null&&i!==void 0?i:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(r=e.right)!==null&&r!==void 0?r:t,bottom:(o=e.bottom)!==null&&o!==void 0?o:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function Mt(e,t){var i=at(t.settings.margin,0);return e.pageSize().width-(i.left+i.right)}function ee(e,t,i,n,r){var o={},s=1.3333333333333333,l=dt(t,function(H){return r.getComputedStyle(H).backgroundColor});l!=null&&(o.fillColor=l);var d=dt(t,function(H){return r.getComputedStyle(H).color});d!=null&&(o.textColor=d);var a=ie(n,i);a&&(o.cellPadding=a);var f="borderTopColor",h=s*i,u=n.borderTopWidth;if(n.borderBottomWidth===u&&n.borderRightWidth===u&&n.borderLeftWidth===u){var c=(parseFloat(u)||0)/h;c&&(o.lineWidth=c)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/h,right:(parseFloat(n.borderRightWidth)||0)/h,bottom:(parseFloat(n.borderBottomWidth)||0)/h,left:(parseFloat(n.borderLeftWidth)||0)/h},o.lineWidth.top||(o.lineWidth.right?f="borderRightColor":o.lineWidth.bottom?f="borderBottomColor":o.lineWidth.left&&(f="borderLeftColor"));var p=dt(t,function(H){return r.getComputedStyle(H)[f]});p!=null&&(o.lineColor=p);var C=["left","right","center","justify"];C.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),C=["middle","bottom","top"],C.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var S=parseInt(n.fontSize||"");isNaN(S)||(o.fontSize=S/s);var T=ne(n);T&&(o.fontStyle=T);var N=(n.fontFamily||"").toLowerCase();return e.indexOf(N)!==-1&&(o.font=N),o}function ne(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function dt(e,t){var i=Ft(e,t);if(!i)return null;var n=i.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var r=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function Ft(e,t){var i=t(e);return i==="rgba(0, 0, 0, 0)"||i==="transparent"||i==="initial"||i==="inherit"?e.parentElement==null?null:Ft(e.parentElement,t):i}function ie(e,t){var i=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),r=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,o=i.map(function(l){return parseInt(l||"0")/n}),s=at(o,0);return r>s.top&&(s.top=r),r>s.bottom&&(s.bottom=r),s}function jt(e,t,i,n,r){var o,s;n===void 0&&(n=!1),r===void 0&&(r=!1);var l;typeof t=="string"?l=i.document.querySelector(t):l=t;var d=Object.keys(e.getFontList()),a=e.scaleFactor(),f=[],h=[],u=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:f,body:h,foot:u};for(var c=0;c<l.rows.length;c++){var p=l.rows[c],C=(s=(o=p?.parentElement)===null||o===void 0?void 0:o.tagName)===null||s===void 0?void 0:s.toLowerCase(),S=re(d,a,i,p,n,r);S&&(C==="thead"?f.push(S):C==="tfoot"?u.push(S):h.push(S))}return{head:f,body:h,foot:u}}function re(e,t,i,n,r,o){for(var s=new Rt(n),l=0;l<n.cells.length;l++){var d=n.cells[l],a=i.getComputedStyle(d);if(r||a.display!=="none"){var f=void 0;o&&(f=ee(e,d,t,a,i)),s.push({rowSpan:d.rowSpan,colSpan:d.colSpan,styles:f,_element:d,content:oe(d)})}}var h=i.getComputedStyle(n);if(s.length>0&&(r||h.display!=="none"))return s}function oe(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(i){return i.trim()}).join(`
`),t.innerText||t.textContent||""}function ae(e,t,i){for(var n=0,r=[e,t,i];n<r.length;n++){var o=r[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function _(e,t,i,n,r){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),s=1;s<arguments.length;s++){var l=arguments[s];if(l!=null)for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(o[d]=l[d])}return o}function se(e,t){var i=new et(e),n=i.getDocumentOptions(),r=i.getGlobalOptions();ae(r,n,t);var o=_({},r,n,t),s;typeof window<"u"&&(s=window);var l=le(r,n,t),d=de(r,n,t),a=fe(i,o),f=ce(i,o,s);return{id:t.tableId,content:f,hooks:d,styles:l,settings:a}}function le(e,t,i){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},r=function(d){if(d==="columnStyles"){var a=e[d],f=t[d],h=i[d];n.columnStyles=_({},a,f,h)}else{var u=[e,t,i],c=u.map(function(p){return p[d]||{}});n[d]=_({},c[0],c[1],c[2])}},o=0,s=Object.keys(n);o<s.length;o++){var l=s[o];r(l)}return n}function de(e,t,i){for(var n=[e,t,i],r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,s=n;o<s.length;o++){var l=s[o];l.didParseCell&&r.didParseCell.push(l.didParseCell),l.willDrawCell&&r.willDrawCell.push(l.willDrawCell),l.didDrawCell&&r.didDrawCell.push(l.didDrawCell),l.willDrawPage&&r.willDrawPage.push(l.willDrawPage),l.didDrawPage&&r.didDrawPage.push(l.didDrawPage)}return r}function fe(e,t){var i,n,r,o,s,l,d,a,f,h,u,c,p=at(t.margin,40/e.scaleFactor()),C=(i=he(e,t.startY))!==null&&i!==void 0?i:p.top,S;t.showFoot===!0?S="everyPage":t.showFoot===!1?S="never":S=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var T;t.showHead===!0?T="everyPage":t.showHead===!1?T="never":T=(r=t.showHead)!==null&&r!==void 0?r:"everyPage";var N=(o=t.useCss)!==null&&o!==void 0?o:!1,H=t.theme||(N?"plain":"striped"),z=!!t.horizontalPageBreak,st=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(l=t.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:N,theme:H,startY:C,margin:p,pageBreak:(d=t.pageBreak)!==null&&d!==void 0?d:"auto",rowPageBreak:(a=t.rowPageBreak)!==null&&a!==void 0?a:"auto",tableWidth:(f=t.tableWidth)!==null&&f!==void 0?f:"auto",showHead:T,showFoot:S,tableLineWidth:(h=t.tableLineWidth)!==null&&h!==void 0?h:0,tableLineColor:(u=t.tableLineColor)!==null&&u!==void 0?u:200,horizontalPageBreak:z,horizontalPageBreakRepeat:st,horizontalPageBreakBehaviour:(c=t.horizontalPageBreakBehaviour)!==null&&c!==void 0?c:"afterAllRows"}}function he(e,t){var i=e.getLastAutoTable(),n=e.scaleFactor(),r=e.pageNumber(),o=!1;if(i&&i.startPageNumber){var s=i.startPageNumber+i.pageNumber-1;o=s===r}return typeof t=="number"?t:(t==null||t===!1)&&o&&i?.finalY!=null?i.finalY+20/n:null}function ce(e,t,i){var n=t.head||[],r=t.body||[],o=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(i){var l=jt(e,t.html,i,s,t.useCss)||{};n=l.head||n,r=l.body||n,o=l.foot||n}else console.error("Cannot parse html in non browser environment")}var d=t.columns||ue(n,r,o);return{columns:d,head:n,body:r,foot:o}}function ue(e,t,i){var n=e[0]||t[0]||i[0]||[],r=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var s=1,l;Array.isArray(n)?l=n[parseInt(o)]:l=n[o],typeof l=="object"&&!Array.isArray(l)&&(s=l?.colSpan||1);for(var d=0;d<s;d++){var a=void 0;Array.isArray(n)?a=r.length:a=o+(d>0?"_".concat(d):"");var f={dataKey:a};r.push(f)}}),r}var gt=(function(){function e(t,i,n){this.table=i,this.pageNumber=i.pageNumber,this.settings=i.settings,this.cursor=n,this.doc=t.getDocument()}return e})(),ge=(function(e){Nt(t,e);function t(i,n,r,o,s,l){var d=e.call(this,i,n,l)||this;return d.cell=r,d.row=o,d.column=s,d.section=o.section,d}return t})(gt),pe=(function(){function e(t,i){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=i.columns,this.head=i.head,this.body=i.body,this.foot=i.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(i,n){return i+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(i,n){return i+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,i,n,r,o,s){for(var l=0,d=i;l<d.length;l++){var a=d[l],f=new ge(t,this,n,r,o,s),h=a(f)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],h)return!1}return!0},e.prototype.callEndPageHooks=function(t,i){t.applyStyles(t.userStyles);for(var n=0,r=this.hooks.didDrawPage;n<r.length;n++){var o=r[n];o(new gt(t,this,i))}},e.prototype.callWillDrawPageHooks=function(t,i){for(var n=0,r=this.hooks.willDrawPage;n<r.length;n++){var o=r[n];o(new gt(t,this,i))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var i=this.columns.reduce(function(r,o){return r+o.wrappedWidth},0);return i}else{var n=this.settings.margin;return t-n.left-n.right}},e})(),kt=(function(){function e(t,i,n,r,o){o===void 0&&(o=!1),this.height=0,this.raw=t,t instanceof Rt&&(this.raw=t._element,this.element=t._element),this.index=i,this.section=n,this.cells=r,this.spansMultiplePages=o}return e.prototype.getMaxCellHeight=function(t){var i=this;return t.reduce(function(n,r){var o;return Math.max(n,((o=i.cells[r.index])===null||o===void 0?void 0:o.height)||0)},0)},e.prototype.hasRowSpan=function(t){var i=this;return t.filter(function(n){var r=i.cells[n.index];return r?r.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,i){return this.getMaxCellHeight(i)<=t},e.prototype.getMinimumRowHeight=function(t,i){var n=this;return t.reduce(function(r,o){var s=n.cells[o.index];if(!s)return 0;var l=i.getLineHeight(s.styles.fontSize),d=s.padding("vertical"),a=d+l;return a>r?a:r},0)},e})(),Ht=(function(){function e(t,i,n){var r;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=i,this.section=n,this.raw=t;var o=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,o=(r=t.content)!==null&&r!==void 0?r:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=o!=null?""+o:"",l=/\r\n|\r|\n/g;this.text=s.split(l)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var i=this.height-this.padding("vertical");t=this.y+i/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var r=this.width-this.padding("horizontal");n=this.x+r/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,i){i===void 0&&(i=1.15);var n=Array.isArray(this.text)?this.text.length:1,r=this.styles.fontSize/t*i,o=n*r+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},e.prototype.padding=function(t){var i=at(this.styles.cellPadding,0);return t==="vertical"?i.top+i.bottom:t==="horizontal"?i.left+i.right:i[t]},e})(),ve=(function(){function e(t,i,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=i,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var i=0,n=0,r=t.allRows();n<r.length;n++){var o=r[n],s=o.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(i=Math.max(i,s.styles.cellWidth))}return i},e})();function ye(e,t){me(e,t);var i=[],n=0;t.columns.forEach(function(o){var s=o.getMaxCustomCellWidth(t);s?o.width=s:(o.width=o.wrappedWidth,i.push(o)),n+=o.width});var r=t.getWidth(e.pageSize().width)-n;r&&(r=pt(i,r,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),r&&(r=pt(i,r,function(o){return o.minWidth})),r=Math.abs(r),!t.settings.horizontalPageBreak&&r>.1/e.scaleFactor()&&(r=r<1?r:Math.round(r),console.log("Of the table content, ".concat(r," units width could not fit page"))),Se(t),we(t,e),xe(t)}function me(e,t){var i=e.scaleFactor(),n=t.settings.horizontalPageBreak,r=Mt(e,t);t.allRows().forEach(function(o){for(var s=0,l=t.columns;s<l.length;s++){var d=l[s],a=o.cells[d.index];if(a){var f=t.hooks.didParseCell;t.callCellHooks(e,f,a,o,d,null);var h=a.padding("horizontal");a.contentWidth=rt(a.text,a.styles,e)+h;var u=rt(a.text.join(" ").split(/[^\S\u00A0]+/),a.styles,e);if(a.minReadableWidth=u+a.padding("horizontal"),typeof a.styles.cellWidth=="number")a.minWidth=a.styles.cellWidth,a.wrappedWidth=a.styles.cellWidth;else if(a.styles.cellWidth==="wrap"||n===!0)a.contentWidth>r?(a.minWidth=r,a.wrappedWidth=r):(a.minWidth=a.contentWidth,a.wrappedWidth=a.contentWidth);else{var c=10/i;a.minWidth=a.styles.minCellWidth||c,a.wrappedWidth=a.contentWidth,a.minWidth>a.wrappedWidth&&(a.wrappedWidth=a.minWidth)}}}}),t.allRows().forEach(function(o){for(var s=0,l=t.columns;s<l.length;s++){var d=l[s],a=o.cells[d.index];if(a&&a.colSpan===1)d.wrappedWidth=Math.max(d.wrappedWidth,a.wrappedWidth),d.minWidth=Math.max(d.minWidth,a.minWidth),d.minReadableWidth=Math.max(d.minReadableWidth,a.minReadableWidth);else{var f=t.styles.columnStyles[d.dataKey]||t.styles.columnStyles[d.index]||{},h=f.cellWidth||f.minCellWidth;h&&typeof h=="number"&&(d.minWidth=h,d.wrappedWidth=h)}a&&(a.colSpan>1&&!d.minWidth&&(d.minWidth=a.minWidth),a.colSpan>1&&!d.wrappedWidth&&(d.wrappedWidth=a.minWidth))}})}function pt(e,t,i){for(var n=t,r=e.reduce(function(c,p){return c+p.wrappedWidth},0),o=0;o<e.length;o++){var s=e[o],l=s.wrappedWidth/r,d=n*l,a=s.width+d,f=i(s),h=a<f?f:a;t-=h-s.width,s.width=h}if(t=Math.round(t*1e10)/1e10,t){var u=e.filter(function(c){return t<0?c.width>i(c):!0});u.length&&(t=pt(u,t,i))}return t}function xe(e){for(var t={},i=1,n=e.allRows(),r=0;r<n.length;r++)for(var o=n[r],s=0,l=e.columns;s<l.length;s++){var d=l[s],a=t[d.index];if(i>1)i--,delete o.cells[d.index];else if(a)a.cell.height+=o.height,i=a.cell.colSpan,delete o.cells[d.index],a.left--,a.left<=1&&delete t[d.index];else{var f=o.cells[d.index];if(!f)continue;if(f.height=o.height,f.rowSpan>1){var h=n.length-r,u=f.rowSpan>h?h:f.rowSpan;t[d.index]={cell:f,left:u,row:o}}}}}function Se(e){for(var t=e.allRows(),i=0;i<t.length;i++)for(var n=t[i],r=null,o=0,s=0,l=0;l<e.columns.length;l++){var d=e.columns[l];if(s-=1,s>1&&e.columns[l+1])o+=d.width,delete n.cells[d.index];else if(r){var a=r;delete n.cells[d.index],r=null,a.width=d.width+o}else{var a=n.cells[d.index];if(!a)continue;if(s=a.colSpan,o=0,a.colSpan>1){r=a,o+=d.width;continue}a.width=d.width+o}}}function we(e,t){for(var i={count:0,height:0},n=0,r=e.allRows();n<r.length;n++){for(var o=r[n],s=0,l=e.columns;s<l.length;s++){var d=l[s],a=o.cells[d.index];if(a){t.applyStyles(a.styles,!0);var f=a.width-a.padding("horizontal");if(a.styles.overflow==="linebreak")a.text=t.splitTextToSize(a.text,f+1/t.scaleFactor(),{fontSize:a.styles.fontSize});else if(a.styles.overflow==="ellipsize")a.text=wt(a.text,f,a.styles,t,"...");else if(a.styles.overflow==="hidden")a.text=wt(a.text,f,a.styles,t,"");else if(typeof a.styles.overflow=="function"){var h=a.styles.overflow(a.text,f);typeof h=="string"?a.text=[h]:a.text=h}a.contentHeight=a.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var u=a.contentHeight/a.rowSpan;a.rowSpan>1&&i.count*i.height<u*a.rowSpan?i={height:u,count:a.rowSpan}:i&&i.count>0&&i.height>u&&(u=i.height),u>o.height&&(o.height=u)}}i.count--}}function wt(e,t,i,n,r){return e.map(function(o){return Ce(o,t,i,n,r)})}function Ce(e,t,i,n,r){var o=1e4*n.scaleFactor();if(t=Math.ceil(t*o)/o,t>=rt(e,i,n))return e;for(;t<rt(e+r,i,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+r}function Ee(e,t){var i=new et(e),n=be(t,i.scaleFactor()),r=new pe(t,n);return ye(i,r),i.applyStyles(i.userStyles),r}function be(e,t){var i=e.content,n=Ae(i.columns);if(i.head.length===0){var r=Ct(n,"head");r&&i.head.push(r)}if(i.foot.length===0){var r=Ct(n,"foot");r&&i.foot.push(r)}var o=e.settings.theme,s=e.styles;return{columns:n,head:ft("head",i.head,n,s,o,t),body:ft("body",i.body,n,s,o,t),foot:ft("foot",i.foot,n,s,o,t)}}function ft(e,t,i,n,r,o){var s={},l=t.map(function(d,a){for(var f=0,h={},u=0,c=0,p=0,C=i;p<C.length;p++){var S=C[p];if(s[S.index]==null||s[S.index].left===0)if(c===0){var T=void 0;Array.isArray(d)?T=d[S.index-u-f]:T=d[S.dataKey];var N={};typeof T=="object"&&!Array.isArray(T)&&(N=T?.styles||{});var H=Te(e,S,a,r,n,o,N),z=new Ht(T,H,e);h[S.dataKey]=z,h[S.index]=z,c=z.colSpan-1,s[S.index]={left:z.rowSpan-1,times:c}}else c--,u++;else s[S.index].left--,c=s[S.index].times,f++}return new kt(d,a,e,h)});return l}function Ct(e,t){var i={};return e.forEach(function(n){if(n.raw!=null){var r=De(t,n.raw);r!=null&&(i[n.dataKey]=r)}}),Object.keys(i).length>0?i:null}function De(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function Ae(e){return e.map(function(t,i){var n,r;return typeof t=="object"?r=(n=t.dataKey)!==null&&n!==void 0?n:i:r=i,new ve(r,t,i)})}function Te(e,t,i,n,r,o,s){var l=te(n),d;e==="head"?d=r.headStyles:e==="body"?d=r.bodyStyles:e==="foot"&&(d=r.footStyles);var a=_({},l.table,l[e],r.styles,d),f=r.columnStyles[t.dataKey]||r.columnStyles[t.index]||{},h=e==="body"?f:{},u=e==="body"&&i%2===0?_({},l.alternateRow,r.alternateRowStyles):{},c=Xt(o),p=_({},c,a,u,h);return _(p,s)}function Pe(e,t,i){var n;i===void 0&&(i={});var r=Mt(e,t),o=new Map,s=[],l=[],d=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?d=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(d=[t.settings.horizontalPageBreakRepeat]),d.forEach(function(u){var c=t.columns.find(function(p){return p.dataKey===u||p.index===u});c&&!o.has(c.index)&&(o.set(c.index,!0),s.push(c.index),l.push(t.columns[c.index]),r-=c.wrappedWidth)});for(var a=!0,f=(n=i?.start)!==null&&n!==void 0?n:0;f<t.columns.length;){if(o.has(f)){f++;continue}var h=t.columns[f].wrappedWidth;if(a||r>=h)a=!1,s.push(f),l.push(t.columns[f]),r-=h;else break;f++}return{colIndexes:s,columns:l,lastIndex:f-1}}function Ie(e,t){for(var i=[],n=0;n<t.columns.length;n++){var r=Pe(e,t,{start:n});r.columns.length&&(i.push(r),n=r.lastIndex)}return i}function Ne(e,t){var i=t.settings,n=i.startY,r=i.margin,o={x:r.left,y:n},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=n+r.bottom+s;if(i.pageBreak==="avoid"){var d=t.body,a=d.reduce(function(u,c){return u+c.height},0);l+=a}var f=new et(e);(i.pageBreak==="always"||i.startY!=null&&l>f.pageSize().height)&&(zt(f),o.y=r.top),t.callWillDrawPageHooks(f,o);var h=_({},o);t.startPageNumber=f.pageNumber(),i.horizontalPageBreak?Re(f,t,h,o):(f.applyStyles(f.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&t.head.forEach(function(u){return G(f,t,u,o,t.columns)}),f.applyStyles(f.userStyles),t.body.forEach(function(u,c){var p=c===t.body.length-1;ot(f,t,u,p,h,o,t.columns)}),f.applyStyles(f.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&t.foot.forEach(function(u){return G(f,t,u,o,t.columns)})),Ot(f,t,h,o),t.callEndPageHooks(f,o),t.finalY=o.y,e.lastAutoTable=t,f.applyStyles(f.userStyles)}function Re(e,t,i,n){var r=Ie(e,t),o=t.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")r.forEach(function(a,f){e.applyStyles(e.userStyles),f>0?it(e,t,i,n,a.columns,!0):Et(e,t,n,a.columns),Oe(e,t,i,n,a.columns),ht(e,t,n,a.columns)});else for(var s=-1,l=r[0],d=function(){var a=s;if(l){e.applyStyles(e.userStyles);var f=l.columns;s>=0?it(e,t,i,n,f,!0):Et(e,t,n,f),a=bt(e,t,s+1,n,f),ht(e,t,n,f)}var h=a-s;r.slice(1).forEach(function(u){e.applyStyles(e.userStyles),it(e,t,i,n,u.columns,!0),bt(e,t,s+1,n,u.columns,h),ht(e,t,n,u.columns)}),s=a};s<t.body.length-1;)d()}function Et(e,t,i,n){var r=t.settings;e.applyStyles(e.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(o){return G(e,t,o,i,n)})}function Oe(e,t,i,n,r){e.applyStyles(e.userStyles),t.body.forEach(function(o,s){var l=s===t.body.length-1;ot(e,t,o,l,i,n,r)})}function bt(e,t,i,n,r,o){e.applyStyles(e.userStyles),o=o??t.body.length;var s=Math.min(i+o,t.body.length),l=-1;return t.body.slice(i,s).forEach(function(d,a){var f=i+a===t.body.length-1,h=Wt(e,t,f,n);d.canEntireRowFit(h,r)&&(G(e,t,d,n,r),l=i+a)}),l}function ht(e,t,i,n){var r=t.settings;e.applyStyles(e.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(o){return G(e,t,o,i,n)})}function Le(e,t,i){var n=i.getLineHeight(e.styles.fontSize),r=e.padding("vertical"),o=Math.floor((t-r)/n);return Math.max(0,o)}function Me(e,t,i,n){var r={};e.spansMultiplePages=!0,e.height=0;for(var o=0,s=0,l=i.columns;s<l.length;s++){var d=l[s],a=e.cells[d.index];if(a){Array.isArray(a.text)||(a.text=[a.text]);var f=new Ht(a.raw,a.styles,a.section);f=_(f,a),f.text=[];var h=Le(a,t,n);a.text.length>h&&(f.text=a.text.splice(h,a.text.length));var u=n.scaleFactor(),c=n.getLineHeightFactor();a.contentHeight=a.getContentHeight(u,c),a.contentHeight>=t&&(a.contentHeight=t,f.styles.minCellHeight-=t),a.contentHeight>e.height&&(e.height=a.contentHeight),f.contentHeight=f.getContentHeight(u,c),f.contentHeight>o&&(o=f.contentHeight),r[d.index]=f}}var p=new kt(e.raw,-1,e.section,r,!0);p.height=o;for(var C=0,S=i.columns;C<S.length;C++){var d=S[C],f=p.cells[d.index];f&&(f.height=p.height);var a=e.cells[d.index];a&&(a.height=e.height)}return p}function Fe(e,t,i,n){var r=e.pageSize().height,o=n.settings.margin,s=o.top+o.bottom,l=r-s;t.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var d=t.getMinimumRowHeight(n.columns,e),a=d<i;if(d>l)return console.log("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!a)return!1;var f=t.hasRowSpan(n.columns),h=t.getMaxCellHeight(n.columns)>l;return h?(f&&console.log("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||n.settings.rowPageBreak==="avoid")}function ot(e,t,i,n,r,o,s){var l=Wt(e,t,n,o);if(i.canEntireRowFit(l,s))G(e,t,i,o,s);else if(Fe(e,i,l,t)){var d=Me(i,l,t,e);G(e,t,i,o,s),it(e,t,r,o,s),ot(e,t,d,n,r,o,s)}else it(e,t,r,o,s),ot(e,t,i,n,r,o,s)}function G(e,t,i,n,r){n.x=t.settings.margin.left;for(var o=0,s=r;o<s.length;o++){var l=s[o],d=i.cells[l.index];if(!d){n.x+=l.width;continue}e.applyStyles(d.styles),d.x=n.x,d.y=n.y;var a=t.callCellHooks(e,t.hooks.willDrawCell,d,i,l,n);if(a===!1){n.x+=l.width;continue}je(e,d,n);var f=d.getTextPos();It(d.text,f.x,f.y,{halign:d.styles.halign,valign:d.styles.valign,maxWidth:Math.ceil(d.width-d.padding("left")-d.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,d,i,l,n),n.x+=l.width}n.y+=i.height}function je(e,t,i){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var r=Lt(n.lineWidth,n.fillColor);r&&e.rect(t.x,i.y,t.width,t.height,r)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,i.y,t.width,t.height,"F"),ke(e,t,i,n.lineWidth))}function ke(e,t,i,n){var r,o,s,l;n.top&&(r=i.x,o=i.y,s=i.x+t.width,l=i.y,n.right&&(s+=.5*n.right),n.left&&(r-=.5*n.left),d(n.top,r,o,s,l)),n.bottom&&(r=i.x,o=i.y+t.height,s=i.x+t.width,l=i.y+t.height,n.right&&(s+=.5*n.right),n.left&&(r-=.5*n.left),d(n.bottom,r,o,s,l)),n.left&&(r=i.x,o=i.y,s=i.x,l=i.y+t.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),d(n.left,r,o,s,l)),n.right&&(r=i.x+t.width,o=i.y,s=i.x+t.width,l=i.y+t.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),d(n.right,r,o,s,l));function d(a,f,h,u,c){e.getDocument().setLineWidth(a),e.getDocument().line(f,h,u,c,"S")}}function Wt(e,t,i,n){var r=t.settings.margin.bottom,o=t.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&i)&&(r+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-r}function it(e,t,i,n,r,o){r===void 0&&(r=[]),o===void 0&&(o=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!o&&t.foot.forEach(function(l){return G(e,t,l,n,r)}),t.callEndPageHooks(e,n);var s=t.settings.margin;Ot(e,t,i,n),zt(e),t.pageNumber++,n.x=s.left,n.y=s.top,i.y=s.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(l){return G(e,t,l,n,r)}),e.applyStyles(e.userStyles))}function zt(e){var t=e.pageNumber();e.setPage(t+1);var i=e.pageNumber();return i===t?(e.addPage(),!0):!1}function He(e){e.API.autoTable=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t[0],r=se(this,n),o=Ee(this,r);return Ne(this,o),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,i,n,r){It(t,i,n,r,this)},e.API.autoTableSetDefaults=function(t){return et.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,i){et.setDefaults(t,i)},e.API.autoTableHtmlToJson=function(t,i){var n;if(i===void 0&&(i=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var r=new et(this),o=jt(r,t,window,i,!1),s=o.head,l=o.body,d=((n=s[0])===null||n===void 0?void 0:n.map(function(a){return a.content}))||[];return{columns:d,rows:l,data:l}}}var ct;try{if(typeof window<"u"&&window){var Dt=window,At=Dt.jsPDF||((ct=Dt.jspdf)===null||ct===void 0?void 0:ct.jsPDF);At&&He(At)}}catch(e){console.error("Could not apply autoTable plugin",e)}const We=Pt.divIcon({html:'<div style="background-color: #39FF14; width: 12px; height: 12px; border-radius: 50%; box-shadow: 0 0 8px #39FF14;"></div>',className:"fleet-marker",iconSize:[12,12]}),ze=Pt.divIcon({html:'<div style="background-color: #06b6d4; width: 14px; height: 14px; border-radius: 50%; box-shadow: 0 0 15px cyan; border: 2px solid white; animation: pulse 1s infinite;"></div>',className:"job-marker",iconSize:[14,14]}),Q=6.2442,Z=-75.5812;function Be({onClose:e,onHome:t,command:i,simulationData:n,activeLayers:r}){const[o,s]=x.useState([]),[l,d]=x.useState([]),[a,f]=x.useState([]);return x.useEffect(()=>{if(n){if(n.planes&&f(n.planes),n.services){const u=n.services.slice(0,15).map((c,p)=>({id:c.plate||`V-0${p+10}`,lat:c.lat||Q+(Math.random()-.5)*.05,lng:c.lng||Z+(Math.random()-.5)*.05,status:c.status==="COMPLETED"?"ACTIVE":"IDLE",speed:Math.floor(Math.random()*60)+20,target:null,driver:c.driver_name}));s(u)}}else{const h=Array.from({length:15}).map((c,p)=>({id:`V-0${p+10}`,lat:Q+(Math.random()-.5)*.06,lng:Z+(Math.random()-.5)*.06,status:Math.random()>.6?"ACTIVE":"IDLE",speed:0,target:null}));s(h);const u=Array.from({length:5}).map((c,p)=>({id:`AV-${900+p}`,lat:Q+(Math.random()-.5)*.1,lng:Z+(Math.random()-.5)*.1,heading:Math.floor(Math.random()*360),speed:300+Math.floor(Math.random()*200),alt:15e3,status:"IN_AIR",from:"MIA"}));f(u)}},[n]),x.useEffect(()=>{if(i==="DISPATCH_WAVE"){console.log("âš¡ WAVE TRIGGERED: Spawning Jobs...");const h=Array.from({length:5}).map((u,c)=>({id:`REQ-${Math.floor(Math.random()*9e3)+1e3}`,lat:Q+(Math.random()-.5)*.03,lng:Z+(Math.random()-.5)*.03,status:"SEARCHING"}));d(u=>[...u,...h]),s(u=>u.map(c=>c.status==="IDLE"&&Math.random()>.4?{...c,status:"DISPATCHED",speed:45}:c))}},[i]),x.useEffect(()=>{const h=setInterval(()=>{s(u=>u.map(c=>c.status==="ACTIVE"||c.status==="DISPATCHED"?{...c,lat:c.lat+(Math.random()-.5)*.0015,lng:c.lng+(Math.random()-.5)*.0015,speed:Math.max(20,Math.floor(Math.random()*70))}:c))},1e3);return()=>clearInterval(h)},[]),x.useEffect(()=>{const h=setInterval(()=>{f(u=>u.map(c=>{const p=(c.heading||0)*(Math.PI/180),C=(c.speed||300)*5e-6;let S=c.lat+Math.cos(p)*C,T=c.lng+Math.sin(p)*C;return Math.abs(S-Q)>.2&&(S=Q),Math.abs(T-Z)>.2&&(T=Z),{...c,lat:S,lng:T}}))},100);return()=>clearInterval(h)},[]),g.jsx("div",{style:{position:"relative",width:"100%",height:"100%",background:"#000000"},children:g.jsxs(Jt,{center:[Q,Z],zoom:13,style:{height:"100%",width:"100%"},zoomControl:!1,attributionControl:!1,children:[g.jsx(qt,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors Â© <a href="https://carto.com/attributions">CARTO</a>',opacity:1}),(!r||r.includes("FLEET"))&&o.map(h=>g.jsx(mt,{position:[h.lat,h.lng],icon:We,children:g.jsx(xt,{children:g.jsxs("div",{style:{color:"#000"},children:[g.jsx("strong",{children:h.id}),g.jsx("br",{}),"Status: ",h.status,g.jsx("br",{}),"Speed: ",h.speed," km/h"]})})},h.id)),(!r||r.includes("JOBS"))&&l.map(h=>g.jsx(mt,{position:[h.lat,h.lng],icon:ze,children:g.jsx(xt,{children:g.jsxs("div",{style:{color:"#000"},children:[g.jsx("strong",{children:"NEW REQUEST"}),g.jsx("br",{}),h.id,g.jsx("br",{}),"Status: ",h.status]})})},h.id)),(!r||r.includes("RADAR"))&&a.map(h=>g.jsx(Qt,{p:h,isSelected:!1},h.id))]})})}function _e({activeTab:e,onTabChange:t}){const i=[{id:"FLOTA",icon:"ðŸš™",label:"FLOTA"},{id:"ORDENES",icon:"ðŸ“¦",label:"ORDENES"},{id:"VUELOS",icon:"âœˆï¸",label:"VUELOS"},{id:"CLIENTES",icon:"ðŸ¢",label:"CLIENTES"},{id:"AGENDA",icon:"ðŸ“…",label:"AGENDA"},{id:"FINANZAS",icon:"ðŸ’°",label:"FINANZAS"},{id:"MERCADO",icon:"ðŸ“¢",label:"MERCADO"},{id:"CORE_V4",icon:"ðŸ”‹",label:"CORE v4.2 LIGHT"}];return g.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"15px",padding:"10px"},children:i.map(n=>g.jsxs("button",{onClick:()=>t(n.id),style:{background:e===n.id?"rgba(6, 182, 212, 0.15)":"rgba(255, 255, 255, 0.03)",backdropFilter:"blur(4px)",border:e===n.id?"1px solid #06b6d4":"1px solid rgba(255, 255, 255, 0.1)",color:e===n.id?"#22d3ee":"#94a3b8",padding:"8px 16px",borderRadius:"12px",display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"0.8rem",fontWeight:"bold",transition:"all 0.2s",boxShadow:e===n.id?"0 0 15px rgba(6, 182, 212, 0.3)":"inset 0 0 10px rgba(0,0,0,0.2)"},children:[g.jsx("span",{children:n.icon}),g.jsx("span",{children:n.label})]},n.id))})}const Ge=({opsCommand:e,simulationData:t})=>{const[i,n]=x.useState("FLOTA"),[r,o]=x.useState(["FLEET","JOBS","RADAR"]),[s,l]=x.useState(!1),d=h=>{o(u=>u.includes(h)?u.filter(c=>c!==h):[...u,h])},a=({activeLayers:h,onToggle:u})=>{const c=p=>{if(p.id==="C_GIT")return window.open("https://github.com/GuillermoHoyos/teso_core","_blank");if(p.id==="PITCH")return window.dispatchEvent(new Event("SHOW_PITCH"));if(p.id==="WHATSAPP")return window.open("https://wa.me/573001234567?text=Hola%20TESO%20AI","_blank");u(p.id)};return g.jsx("div",{style:{position:"absolute",top:"75px",left:"20px",bottom:"100px",display:"flex",flexDirection:"column",gap:"8px",zIndex:400,overflowY:"auto",scrollbarWidth:"none"},children:[{id:"RADAR",label:"RADAR JMC",icon:"ðŸ“¡",color:"#a855f7"},{id:"VISION",label:"VISIÃ“N IA",icon:"ðŸ§ ",color:"#ec4899"},{id:"OPTIMIZE",label:"OPTIMIZE",icon:"ðŸ“ˆ",color:"#f59e0b"},{id:"JOBS",label:"PEDIDOS",icon:"ðŸ”¥",color:"#ef4444"},{id:"FLEET",label:"FLOTA V4",icon:"ðŸš™",color:"#39FF14"},{id:"PITCH",label:"PITCH DECK",icon:"ðŸ“¢",color:"#ec4899"},{id:"WHATSAPP",label:"WHATSAPP",icon:"ðŸ’¬",color:"#22c55e"},{id:"C_GIT",label:"SOURCE GIT",icon:"ðŸ‘¾",color:"#64748b"}].map((p,C)=>{const S=h.includes(p.id);return g.jsxs("div",{onClick:()=>c(p),style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",opacity:S||["PITCH","WHATSAPP","C_GIT"].includes(p.id)?1:.5,transition:"opacity 0.2s"},children:[g.jsx("div",{style:{width:"40px",height:"40px",background:S?`rgba(${parseInt(p.color.slice(1,3),16)}, ${parseInt(p.color.slice(3,5),16)}, ${parseInt(p.color.slice(5,7),16)}, 0.2)`:"rgba(15, 23, 42, 0.9)",border:`1px solid ${p.color}`,borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.2rem",boxShadow:S?`0 0 15px ${p.color}`:"none"},children:p.icon}),g.jsx("div",{style:{color:"#fff",fontSize:"0.7rem",fontWeight:"bold",letterSpacing:"1px",textShadow:"0 2px 4px #000",fontFamily:"monospace"},children:p.label})]},C)})})},f=()=>g.jsxs("div",{style:{width:"350px",background:"rgba(9, 9, 11, 0.95)",borderLeft:"1px solid #334155",display:"flex",flexDirection:"column",padding:"20px",zIndex:50,boxShadow:"-10px 0 40px rgba(0,0,0,0.8)",height:"100%"},children:[g.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[g.jsxs("div",{children:[g.jsx("h2",{style:{margin:0,color:"#ef4444",fontFamily:"monospace",fontSize:"1.2rem"},children:"TESO OPS"}),g.jsxs("div",{style:{fontSize:"0.7rem",color:"#64748b"},children:["UNIDADES: ",t?.services?.length||15," | OPS ACTIVAS: ",t?.services?.filter(h=>h.status!=="COMPLETED").length||60]})]}),g.jsx("div",{style:{width:"30px",height:"30px",borderRadius:"50%",border:"1px solid #ea580c",display:"flex",alignItems:"center",justifyContent:"center",color:"#ea580c",cursor:"pointer"},children:"ðŸ "})]}),g.jsxs("div",{style:{marginBottom:"20px",position:"relative"},children:[g.jsx("input",{type:"text",placeholder:"Buscar Orden, Unidad, Cliente [ENTER]",style:{width:"100%",background:"#1e293b",border:"1px solid #334155",borderRadius:"4px",padding:"8px 10px",color:"#fff",fontSize:"0.8rem",outline:"none"}}),g.jsx("span",{style:{position:"absolute",right:"10px",top:"8px",color:"#64748b"},children:"ðŸ”"})]}),g.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"20px"},children:[g.jsx("button",{style:{background:"rgba(6, 182, 212, 0.1)",border:"1px solid #06b6d4",color:"#06b6d4",padding:"10px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",fontWeight:"bold",fontSize:"0.8rem"},children:"â–¶ INICIAR SIMULACIÃ“N"}),g.jsx("button",{style:{background:"rgba(234, 88, 12, 0.1)",border:"1px solid #ea580c",color:"#ea580c",padding:"10px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",fontWeight:"bold",fontSize:"0.8rem"},children:"âš¡ DESPACHO INTELIGENTE"})]}),g.jsxs("div",{style:{background:"#000",border:"1px solid #1e293b",borderRadius:"4px",padding:"10px",marginBottom:"20px",height:"120px",overflowY:"auto",fontFamily:"monospace",fontSize:"0.7rem"},children:[g.jsx("div",{style:{color:"#06b6d4",fontWeight:"bold",marginBottom:"5px"},children:"CONSOLE.LOG :: SYSTEM EVENTS"}),g.jsxs("div",{style:{color:"#39FF14"},children:["[",new Date().toLocaleTimeString("en-US"),"] ðŸŸ© CORE v4 ONLINE: Grid operational."]}),g.jsxs("div",{style:{color:"#fff"},children:["[",new Date().toLocaleTimeString("en-US"),"] â˜ï¸ CONNECTING: Syncing with VORTEX Node..."]}),g.jsxs("div",{style:{color:"#ef4444"},children:["[",new Date().toLocaleTimeString("en-US"),"] ðŸš€ SYSTEM STARTUP: Orchestrator Active"]})]}),g.jsxs("div",{style:{flex:1,overflowY:"auto"},children:[g.jsxs("div",{style:{color:"#64748b",fontSize:"0.8rem",fontWeight:"bold",marginBottom:"10px",borderBottom:"1px solid #334155",paddingBottom:"5px"},children:["UNIDADES EN LÃNEA (",t?.services?.length||15,")"]}),[{id:"TSO-128",status:"DISPONIBLE",cond:"COND-021"},{id:"TSO-160",status:"DISPONIBLE",cond:"COND-248"},{id:"TSO-109",status:"DISPONIBLE",cond:"COND-142"}].map((h,u)=>g.jsxs("div",{style:{background:"rgba(255,255,255,0.03)",padding:"8px",marginBottom:"5px",borderRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[g.jsxs("div",{children:[g.jsx("div",{style:{color:"#fff",fontWeight:"bold",fontSize:"0.8rem"},children:h.id}),g.jsxs("div",{style:{color:"#64748b",fontSize:"0.7rem"},children:["Cond: ",h.cond]})]}),g.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px",fontSize:"0.7rem",color:"#39FF14"},children:[g.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:"#39FF14"}}),h.status]})]},u))]})]});return g.jsxs("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden",display:"flex"},children:[g.jsx("div",{style:{position:"absolute",top:5,left:20,zIndex:1e3,width:"auto"},children:g.jsx(_e,{activeTab:i,onTabChange:n})}),g.jsx(a,{activeLayers:r,onToggle:d}),i==="FLOTA"&&g.jsxs("div",{style:{position:"absolute",bottom:"80px",left:"20px",width:"350px",background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(10px)",border:"1px solid #334155",borderRadius:"16px",padding:"15px",display:s?"block":"none",zIndex:2e3,boxShadow:"0 20px 50px rgba(0,0,0,0.5)"},children:[g.jsx("div",{style:{fontSize:"0.8rem",color:"#94a3b8",marginBottom:"10px",fontWeight:"bold",letterSpacing:"1px"},children:"SELECT ANALYSIS PROTOCOL"}),[{category:"ðŸ“– DATA STORYTELLING",questions:["Genera una narrativa sobre el estado actual de la operaciÃ³n","Explica las anomalÃ­as recientes como una historia","Â¿CuÃ¡l es el 'clÃ­max' operativo de hoy?"],color:"#fbbf24"},{category:"âš–ï¸ ANÃLISIS DE SESGOS (BIAS)",questions:["Â¿Detectas sesgo algorÃ­tmico en la asignaciÃ³n?","Â¿Hay distribuciÃ³n inequitativa por zonas?","Analiza la equidad de ingresos entre conductores"],color:"#f87171"},{category:"ðŸ“Š BUSINESS INTELLIGENCE",questions:["Resumen ejecutivo de KPIs en tiempo real","PredicciÃ³n de demanda (PrÃ³xima Hora)","Identifica cuellos de botella crÃ­ticos"],color:"#34d399"},{category:"ðŸ¢ ESTRATEGIA CORPORATIVA (Gemini/Copilot)",questions:["AuditorÃ­a de eficiencia Cloud vs On-Premise","EvaluaciÃ³n de Riesgos de ExpansiÃ³n LATAM","ProyecciÃ³n de Crecimiento (Forecast Q4)"],color:"#8b5cf6"}].map((h,u)=>g.jsxs("div",{style:{marginBottom:"15px"},children:[g.jsx("div",{style:{color:h.color,fontSize:"0.9rem",marginBottom:"5px",fontWeight:"bold"},children:h.category}),g.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:h.questions.map((c,p)=>g.jsxs("button",{onClick:()=>{l(!1),console.log("ðŸ—£ï¸ User Query:",c);const C=h.category.includes("ESTRATEGIA"),S=C?"/api/agently/business/gemini":"/api/agently/command",T=C?{query:c}:{intent:"CUSTOM_QUERY",query:c,context:{view:"LIVE_MAP"}};alert(`ðŸ¤– CONTACTANDO AGENTE [${C?"GEMINI BUSINESS":"ORCHESTRATOR"}]...

"${c}"`),fetch(S,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)}).then(N=>N.json()).then(N=>{const H=N.response?.text||N.narrative||"AnÃ¡lisis completado. Datos enviados a consola.";N.response?.voice_script,alert(`ðŸ“Š RESPUESTA DE AGENTE:

${H}`),console.log("Agent Telemetry:",N.meta||N)}).catch(N=>alert(`Error de conexiÃ³n con ${S}: ${N.message}`))},style:{background:"rgba(255,255,255,0.05)",border:"none",borderRadius:"6px",padding:"8px",color:"#e2e8f0",textAlign:"left",fontSize:"0.8rem",cursor:"pointer",transition:"background 0.2s"},onMouseEnter:C=>C.currentTarget.style.background="rgba(255,255,255,0.1)",onMouseLeave:C=>C.currentTarget.style.background="rgba(255,255,255,0.05)",children:["â€¢ ",c]},p))})]},u)),g.jsx("button",{onClick:()=>{const h=prompt("Escribe tu consulta personalizada:");h&&(l(!1),console.log("ðŸ—£ï¸ User Query:",h),alert(`ðŸ¤– PROCESANDO CONSULTA CON LLM/MCP...

"${h}"

(Conectando con Backend Python...)`),fetch("/api/agently/command",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({intent:"CUSTOM_QUERY",query:h,context:{view:"LIVE_MAP"}})}).then(u=>u.json()).then(u=>{const c=u.narrative||"AnÃ¡lisis completado. Datos enviados a consola.";alert(`ðŸ“Š REPORTE DE INTELIGENCIA:

${c}`)}).catch(u=>alert("Error de conexiÃ³n (Backend Offline).")))},style:{width:"100%",padding:"8px",background:"transparent",border:"1px dashed #475569",color:"#94a3b8",borderRadius:"6px",cursor:"pointer"},children:"+ Escribir consulta manual..."})]}),g.jsxs("div",{onClick:()=>l(!s),style:{position:"absolute",bottom:"20px",left:"20px",zIndex:1e3,display:"flex",alignItems:"center",gap:"10px",background:"rgba(15, 23, 42, 0.95)",border:"1px solid #06b6d4",borderRadius:"50px",padding:"10px 25px",boxShadow:"0 0 20px rgba(6, 182, 212, 0.4)",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:h=>h.currentTarget.style.transform="scale(1.05)",onMouseLeave:h=>h.currentTarget.style.transform="scale(1)",children:[g.jsx("div",{style:{fontSize:"1.5rem"},children:"ðŸ¤–"}),g.jsx("div",{style:{color:"#fff",fontSize:"0.9rem",fontFamily:"monospace",fontWeight:"bold"},children:s?"CERRAR PANEL DE INTELIGENCIA":"CONSULTAR INTELLIGENCE (LLM)"}),g.jsx("div",{style:{color:"#06b6d4"},children:s?"â¬‡ï¸":"â¬†ï¸"})]}),g.jsxs("div",{style:{flex:1,position:"relative"},children:[i!=="ORDENES"&&i!=="CLIENTES"&&g.jsx(Be,{command:e,simulationData:t,activeLayers:r}),i==="CLIENTES"&&g.jsx(Zt,{}),i==="ORDENES"&&g.jsx("div",{style:{padding:"50px",color:"#fff"},children:"Logistics View (Active)"})]}),(i==="FLOTA"||i==="VUELOS"||i==="AGENDA")&&g.jsx("div",{style:{height:"100%",zIndex:100},children:g.jsx(f,{})})]})},k={provider:"NATIVE",params:{elevenKey:localStorage.getItem("ELEVEN_API_KEY")||"",voiceId:"ErXwobaYiN019PkySvjV",stability:.5,similarity_boost:.75},isMuted:!1,queue:[]};class Ue{constructor(){this.synth=window.speechSynthesis,this.audioContext=new(window.AudioContext||window.webkitAudioContext)}configure(t,i=null){k.provider=t,i&&(k.params.elevenKey=i,localStorage.setItem("ELEVEN_API_KEY",i))}async speak(t,i="INFO"){k.isMuted||(console.log(`ðŸŽ™ï¸ [${k.provider}] Speaking:`,t),k.provider==="ELEVEN_LABS"&&k.params.elevenKey?await this.speakElevenLabs(t):this.speakNative(t,i))}speakNative(t,i){this.synth.cancel();let n=1,r=1,o=t;(t.includes("[rapid-fire]")||t.includes("[urgent]"))&&(n=1.5),t.includes("[rushed]")&&(n=1.3),(t.includes("[slow down]")||t.includes("[deliberate]"))&&(n=.85),(t.includes("[happy]")||t.includes("[excited]"))&&(r=1.2),(t.includes("[sad]")||t.includes("[calm]"))&&(r=.9),t.includes("[nervous]")&&(n=1.2,r=1.3),t.includes("[robotic]")&&(n=.9,r=.5),o=o.replace(/\[.*?\]/g,"").trim();const s=new SpeechSynthesisUtterance(o),d=this.synth.getVoices().find(a=>a.lang.includes("es")&&(a.name.includes("Google")||a.name.includes("Premium")));d&&(s.voice=d),s.rate=n,s.pitch=r,this.synth.speak(s)}async speakElevenLabs(t){try{const i=await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${k.params.voiceId}`,{method:"POST",headers:{"Content-Type":"application/json","xi-api-key":k.params.elevenKey},body:JSON.stringify({text:t,model_id:"eleven_multilingual_v2",voice_settings:{stability:k.params.stability,similarity_boost:k.params.similarity_boost}})});if(!i.ok)throw new Error("ElevenLabs API Error");const n=await i.arrayBuffer(),r=await this.audioContext.decodeAudioData(n),o=this.audioContext.createBufferSource();o.buffer=r,o.connect(this.audioContext.destination),o.start(0)}catch(i){console.warn("âš ï¸ ElevenLabs Failed, falling back to Native:",i),this.speakNative(t,"INFO")}}stop(){this.synth.cancel()}toggleMute(){return k.isMuted=!k.isMuted,k.isMuted}formatText(t,i="neutral"){const r={angry:"[angry]",calm:"[calm]",curious:"[curious]",excited:"[excited]",happy:"[happy]",nervous:"[nervous]",sad:"[sad]",serious:"[understated]",urgent:"[rapid-fire]",announcement:"[loudly]",whisper:"[whispering]",robotic:"[robotic]",professional:"[deliberate]",sigh:"[sighs]",laugh:"[laughs]",breath:"[breathes]"}[i]||"";return r?`${r} ${t}`:t}}const Tt=new Ue,Ve="/documents/invoices/invoice_sier_service.pdf",$e="/documents/invoices/invoice_viajes_az.pdf",Ye="/documents/invoices/invoice_personal_soft.pdf",Cn=({vehicles:e,requests:t,initialViewMode:i="LIVE_OPS",onRowClick:n,simulationData:r,onClose:o,onHome:s,onRegenerate:l,onSimulateStress:d,onRunMacro:a})=>{const[f,h]=x.useState(r||null),[u,c]=x.useState(!1),[p,C]=x.useState(null),[S,T]=x.useState(!0),[N,H]=x.useState(null),z=(m,A="professional")=>{if(!S)return;const v=/^\s*\[.*\]/.test(m)?m:Tt.formatText(m,A),E=m.includes("[urgent]")||m.includes("[angry]")||A==="urgent"?"CRITICAL":"INFO";Tt.speak(v,E)};x.useEffect(()=>{if(!r||!r.details)return;let m=null;r.details?.agent_analysis?.voice_script?m=r.details.agent_analysis.voice_script:r.analysis?.voice_script&&(m=r.analysis.voice_script),m&&(console.log("ðŸ—£ï¸ AGENT SPEAKING:",m),z(m))},[r]),x.useEffect(()=>{const m={current:null},D=setInterval(async()=>{try{const v=await fetch("https://teso-api-dev.fly.dev/api/agently/alerts");if(!v.ok)return;const F=await v.json();if(F.length>0){const E=F[0];if(E.timestamp!==m.current&&(m.current=E.timestamp,console.log("ðŸš¨ NEW AUTONOMOUS ALERT:",E),E.data&&E.data.analysis)){const O=`Alerta AutÃ³noma. ${E.data.analysis.message}`;z(O)}}}catch{}},3e4);return()=>clearInterval(D)},[]),x.useEffect(()=>{r&&(console.log("ðŸ”„ DASHBOARD: Syncing with Parent Data...",r.services?.length),h(r))},[r]);const[st,Bt]=x.useState(null),[Ke,vt]=x.useState(!1),_t=async()=>{vt(!0);try{const m=await fetch("/api/strategic-cycle",{method:"POST"});if(m.ok){const A=await m.json();Bt(A),A.voice_broadcast&&z(A.voice_broadcast.text)}}catch(m){console.error("CEO Brain Offline:",m)}finally{vt(!1)}};x.useEffect(()=>{if(f&&!st){const m=setTimeout(_t,2e3);return()=>clearTimeout(m)}},[f]),x.useEffect(()=>{if(f)return;(async()=>{console.log("ðŸ“¡ CONNECTING TO TESO OPS V4..."),c(!0);try{const D=await fetch("/api/simulate/core-v4",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cars:15,avg_trips_per_day:40,days:360})});if(!D.ok)throw new Error("Ops Engine Offline");const v=await D.json();console.log("âœ… OPS CONNECTED:",v);const F=v.operational?.annual_trips||14400,E=v.operational?.cars||15,O=new Array(F),L=new Date;L.setDate(L.getDate()-360);for(let P=0;P<F;P++){const I=P%E+1,W=Math.floor(P/40),B=new Date(L);B.setDate(B.getDate()+W),O[P]={id:`TRIP-${P}`,date:B.toISOString(),lat:6.24+(Math.random()*.08-.04),lng:-75.58+(Math.random()*.08-.04),status:"COMPLETED",financials:{totalValue:125e3,driverPayment:82e3,netRevenue:25e3},plate:`TES-${100+I}`,driver_name:`Cond. ${I}`}}const M=O.filter((P,I)=>I%10===0).map(P=>({date:P.date,amount:25e3,type:"INCOME",description:"ComisiÃ³n Teso Ops"})),V=Array.from({length:8}).map((P,I)=>({id:`FL-${500+I}`,lat:6.24+(Math.random()*.1-.05),lng:-75.58+(Math.random()*.1-.05),heading:Math.floor(Math.random()*360),alt:8e3+Math.floor(Math.random()*5e3),spd:240+Math.floor(Math.random()*40),status:Math.random()>.3?"AIRBORNE":"LANDED",from:["MIA","BOG","CLO","JFK","MAD"][Math.floor(Math.random()*5)]}));h({...v,services:O,planes:V,bankTransactions:M})}catch(A){console.error("âŒ OPS ERROR:",A),C(A.message)}finally{c(!1)}})()},[]);const[lt,Gt]=x.useState(i),[Je,qe]=x.useState("PROGRAMACION"),[Qe,Ze]=x.useState(!1),[Xe,tn]=x.useState(null),[R,en]=x.useState("Today"),[nn,rn]=x.useState(!1),[on,an]=x.useState(!1),[U,sn]=x.useState({cxcDays:30,cxpFreq:15,growth:1}),[ln,Ut]=x.useState({status:"STABLE",minCash:0,insolvencyDay:null,runway:"âˆž"});x.useEffect(()=>{let m=[...t||[],...f?.services||[]];if(m.length===0)return;const D=(()=>{const y=new Date;return y.setHours(0,0,0,0),R==="Today"?(y.setDate(y.getDate()-1),y):R==="30D"?(y.setDate(y.getDate()-30),y):R==="90D"?(y.setDate(y.getDate()-90),y):R==="180D"?(y.setDate(y.getDate()-180),y):R==="360D"?(y.setDate(y.getDate()-360),y):new Date("2020-01-01")})();R!=="ALL"&&(m=m.filter(y=>new Date(y.date||0)>=D));const v=[],F=8e8,E=m.map(y=>new Date(y.date).getTime()),O=new Date(Math.min(...E)),L=new Date(Math.max(...E)),M=new Date(L);M.setDate(M.getDate()+parseInt(U.cxcDays)+15),m.forEach(y=>{if(y.status==="CANCELLED")return;const j=new Date(y.date);j.setDate(j.getDate()+parseInt(U.cxcDays)),v.push({date:j,amount:(y.financials?.totalValue||0)*parseFloat(U.growth),type:"INFLOW"})}),m.forEach(y=>{if(y.status==="CANCELLED")return;const j=new Date(y.date),q=j.getDate();let Y=Math.ceil(q/U.cxpFreq)*U.cxpFreq;Y>30&&(Y=30);const nt=new Date(j);q>Y?(nt.setMonth(nt.getMonth()+1),nt.setDate(U.cxpFreq)):nt.setDate(Y),v.push({date:nt,amount:-((y.financials?.driverPayment||0)*parseFloat(U.growth)),type:"OUTFLOW"})});const V=[{desc:"INFRAESTRUCTURA AWS",amount:25e5,day:5},{desc:"OFICINA & ADMIN",amount:45e5,day:1},{desc:"NOMINA SOPORTE (Q1)",amount:6e6,day:15},{desc:"NOMINA SOPORTE (Q2)",amount:6e6,day:30}];let P=new Date(O);for(;P<=M;){const y=P.getMonth(),j=P.getFullYear();V.forEach(q=>{const Y=new Date(j,y,q.day);Y>=O&&Y<=M&&v.push({date:Y,amount:-q.amount,type:"FIXED_COST"})}),P.setMonth(P.getMonth()+1)}v.sort((y,j)=>y.date-j.date);let I=F,W=F,B=F,K=null;const X=[];for(let y of v)I+=y.amount,I<W&&(W=I),I>B&&(B=I),I<0&&!K&&(K=y.date.toLocaleDateString()),X.push(I);const $=X.length,w=Math.max(B-W,1e6),b=y=>90-(y-W)/w*80;let J=`M 0 ${b(F)}`;const tt=Math.ceil($/200);for(let y=0;y<$;y+=tt){const j=y/$*100,q=b(X[y]);J+=` L ${j} ${q}`}Ut({status:W<0?"INSOLVENT":"SUSTAINABLE",minCash:W,insolvencyDay:K,runway:K?`${Math.floor((new Date(K)-new Date)/(1e3*60*60*24))} Days`:"âˆž",graphPath:J,duration:Math.floor($/(m.length/v.length||1)),simDays:Math.ceil($/(v.length/$))})},[f,U,R]),x.useEffect(()=>{i&&Gt(i)},[i]);const[dn,fn]=x.useState({efficiency:94,avgResponse:12,errorRate:0}),[hn,Vt]=x.useState({totalRevenue:0,totalCost:0,margin:0,marginPercent:0,cxcPending:0,cxpPending:0,topClients:[]}),[cn,un]=x.useState(""),[gn,$t]=x.useState([]);x.useEffect(()=>{const A=(()=>{const w=new Date;if(R==="Today")return new Date(w.setDate(w.getDate()-1));const b=new Date;if(R==="7D")return new Date(b.setDate(b.getDate()-7));const J=new Date;if(R==="30D")return new Date(J.setDate(J.getDate()-30));const tt=new Date;return R==="90D"?new Date(tt.setDate(tt.getDate()-90)):new Date("2020-01-01")})(),D=w=>w.date?new Date(w.date)>=A:!0,v=[...t||[],...f?.services||[]],F=f?.bankTransactions||[],E=R==="ALL"?v:v.filter(D),O=R==="ALL"?F:F.filter(D);let L=0,M=0,V=0,P=0;const I={};E.forEach(w=>{const b=w.financials?.totalValue||parseFloat((w.fare||"0").replace(/[^0-9]/g,""))||0,J=w.financials?.totalCost||b*.8,tt=w.financials?.driverPayment||b*.6;if(L+=b,M+=J,w.status!=="CANCELLED"){V+=b,P+=tt;const y=w.company||w.paxName||f?.clients?.find(j=>j.id===w.clientId)?.companyName||"PARTICULAR";I[y]||(I[y]=0),I[y]+=b}});const W=L-M,B=O.filter(w=>w.type==="INCOME").reduce((w,b)=>w+b.amount,0),K=V-B;O.filter(w=>w.type==="EXPENSE"&&(w.description?.includes("NÃ“MINA")||w.description?.includes("PAGO"))).reduce((w,b)=>w+Math.abs(b.amount||0),0);const X=Object.entries(I).map(([w,b])=>({name:w,volume:b,balance:b,status:b>5e6?"VIP PLATINUM":"CORPORATE"})).sort((w,b)=>b.volume-w.volume).slice(0,15);Vt({totalRevenue:L,totalCost:M,margin:W,marginPercent:L>0?(W/L*100).toFixed(1):0,cxcPending:K,cxpPending:P,topClients:X});const $=X.map((w,b)=>({id:`CORP-${100+b}`,name:w.name,currentCycleServices:Math.floor(w.volume/85e3),cycleStatus:w.volume>5e6?"CUTOFF READY":"ACCUMULATING",lastInvoice:`FE-${9e3+b}`,pdf:b<3?[Ve,$e,Ye][b]:null}));$t($)},[t,f,R]);const Yt=m=>{if(!m)return new Date(0);if(m==="Hoy")return new Date;if(m==="MaÃ±ana"){const D=new Date;return D.setDate(D.getDate()+1),D}if(m==="Pasado MaÃ±ana"){const D=new Date;return D.setDate(D.getDate()+2),D}const A=new Date(m);return isNaN(A.getTime())?(console.warn("Invalid Date encountered:",m),new Date(0)):A};(()=>{const m=[...t||[],...f?.services||[]];if(R==="ALL")return m.length;const D=(()=>{const v=new Date;return v.setHours(0,0,0,0),R==="Today"?(v.setDate(v.getDate()-1),v):R==="7D"?(v.setDate(v.getDate()-7),v):R==="30D"?(v.setDate(v.getDate()-30),v):R==="90D"?(v.setDate(v.getDate()-90),v):R==="180D"?(v.setDate(v.getDate()-180),v):new Date("2020-01-01")})();return m.filter(v=>Yt(v.date)>=D).length})();const[vn,yn]=x.useState(null),[mn,Kt]=x.useState({activeOrderId:null,stepIndex:-1,nodes:[{id:"MARKET",icon:"ðŸ“¡",label:"MARKET SENSOR",role:"Demand & IO Handler",status:"SCANNING",load:30,logs:["Listening..."]},{id:"PRICING",icon:"ðŸ§ ",label:"PRICING CORE",role:"Dynamic Calc / Fixed Routes",status:"IDLE",load:0,logs:[]},{id:"FINANCE",icon:"ðŸ›¡ï¸",label:"PAYMENT GUARDIAN",role:"Pre-Service Fund Capture",status:"IDLE",load:0,logs:[]},{id:"COMPLIANCE",icon:"âš–ï¸",label:"LEGAL CHECK",role:"RNT/SOAT Validation",status:"IDLE",load:0,logs:[]},{id:"DISPATCH",icon:"ðŸš€",label:"OPS SENTINEL",role:"Assignment & Routing",status:"IDLE",load:0,logs:[]}]}),[xn,yt]=x.useState([{time:"10:42:01",msg:"System stable. Orchestrator: ONLINE."}]);return x.useEffect(()=>{const m=setInterval(()=>{Kt(A=>{let{activeOrderId:D,stepIndex:v,nodes:F}=A;const E=[...F];if(D===null&&Math.random()>.7){const O=`ORD-${Math.floor(Math.random()*9e3)+1e3}`;return{...A,activeOrderId:O,stepIndex:0,nodes:E.map((L,M)=>M===0?{...L,status:"PROCESSING",load:80,logs:[`New Request: ${O}`]}:L)}}if(D){const O=E[v];if(O.load>0)E[v]={...O,load:Math.max(0,O.load-25)};else{E[v]={...O,status:"DONE",logs:["Completed."]};const L=v+1;if(L<E.length){const M=E[L],V=[["Calculating Tariff..."],["Capturing Funds..."],["Verifying Driver Docs..."],["Dispatching Unit..."]],P=["ðŸ“¡ MARKET -> ðŸ§  PRICING: Request Data { dist: 12km, pax: 'VIP' }","ðŸ§  PRICING -> ðŸ›¡ï¸ FINANCE: Quote Locked $45.000 (Pre-Paid).","ðŸ›¡ï¸ FINANCE -> âš–ï¸ COMPLIANCE: Funds Secured (Tx#99). Verify Asset.","âš–ï¸ COMPLIANCE -> ðŸš€ DISPATCH: Legal Check Passed. Auth to Dispatch."];return P[v]&&yt(I=>[{time:new Date().toLocaleTimeString("es-CO",{hour12:!1}),msg:P[v],type:"HANDSHAKE"},...I.slice(0,9)]),E[L]={...M,status:"WORKING",load:100,logs:V[v]||["Processing..."]},{...A,stepIndex:L,nodes:E}}else return yt(M=>[{time:new Date().toLocaleTimeString("es-CO",{hour12:!1}),msg:`âœ… ORCHESTRATION COMPLETE: ${D} Dispatched w/ Zero Friction.`},...M.slice(0,8)]),{...A,activeOrderId:null,stepIndex:-1,nodes:E.map(M=>({...M,status:"IDLE",load:0,logs:[]}))}}}return D||(E[0]={...E[0],status:"SCANNING",load:30+Math.random()*10}),{...A,nodes:E}})},800);return()=>clearInterval(m)},[]),g.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:lt==="ANALYTICS"?"transparent":"var(--color-bg-app)",pointerEvents:lt==="ANALYTICS"?"none":"auto",color:"var(--color-text-primary)",zIndex:100,padding:"var(--spacing-xl)",display:"flex",flexDirection:"column",fontFamily:"var(--font-main)"},children:lt==="LIVE_OPS"?g.jsx(Ge,{opsCommand:N,simulationData:f}):g.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"#64748b"},children:[g.jsx("div",{style:{fontSize:"3rem"},children:"ðŸš§"}),g.jsx("h2",{children:"ANALYTICS OFFLINE"}),g.jsx("p",{children:"Use Live Ops Map"})]})})};export{Cn as default};
