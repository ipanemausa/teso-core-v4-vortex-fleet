const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/GeminiConsultantArtifact.Ds9Fbn2i.js","assets/index.CoJxdBz7.js","assets/index.Dj_fAJND.css"])))=>i.map(i=>d[i]);
import{E as mt,j as a,r as y,M as bt,T as St,a as fe,v as Ct,P as Re,b as Et,g as At,u as Be,L as wt,p as Dt,c as Tt,R as _e,_ as jt}from"./index.CoJxdBz7.js";import It from"./ClientDashboard.di-h80gK.js";function Ue(n,e,i,t,r){t=t||{};var o=1.15,d=r.internal.scaleFactor,c=r.internal.getFontSize()/d,l=r.getLineHeightFactor?r.getLineHeightFactor():o,s=c*l,f=/\r\n|\r|\n/g,p="",h=1;if((t.valign==="middle"||t.valign==="bottom"||t.halign==="center"||t.halign==="right")&&(p=typeof n=="string"?n.split(f):n,h=p.length||1),i+=c*(2-o),t.valign==="middle"?i-=h/2*s:t.valign==="bottom"&&(i-=h*s),t.halign==="center"||t.halign==="right"){var x=c;if(t.halign==="center"&&(x*=.5),p&&h>=1){for(var u=0;u<p.length;u++)r.text(p[u],e-r.getStringUnitWidth(p[u])*x,i),i+=s;return r}e-=r.getStringUnitWidth(n)*x}return t.halign==="justify"?r.text(n,e,i,{maxWidth:t.maxWidth||100,align:"justify"}):r.text(n,e,i),r}var Pe={},ae=(function(){function n(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return n.setDefaults=function(e,i){i===void 0&&(i=null),i?i.__autoTableDocumentDefaults=e:Pe=e},n.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},n.prototype.applyStyles=function(e,i){var t,r,o;i===void 0&&(i=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var d=this.jsPDFDocument.internal.getFont(),c=d.fontStyle,l=d.fontName;if(e.font&&(l=e.font),e.fontStyle){c=e.fontStyle;var s=this.getFontList()[l];s&&s.indexOf(c)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(s[0]),c=s[0])}if(this.jsPDFDocument.setFont(l,c),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!i){var f=n.unifyColor(e.fillColor);f&&(t=this.jsPDFDocument).setFillColor.apply(t,f),f=n.unifyColor(e.textColor),f&&(r=this.jsPDFDocument).setTextColor.apply(r,f),f=n.unifyColor(e.lineColor),f&&(o=this.jsPDFDocument).setDrawColor.apply(o,f),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},n.prototype.splitTextToSize=function(e,i,t){return this.jsPDFDocument.splitTextToSize(e,i,t)},n.prototype.rect=function(e,i,t,r,o){return this.jsPDFDocument.rect(e,i,t,r,o)},n.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},n.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},n.prototype.getDocument=function(){return this.jsPDFDocument},n.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},n.prototype.addPage=function(){return this.jsPDFDocument.addPage()},n.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},n.prototype.getGlobalOptions=function(){return Pe||{}},n.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},n.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},n.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},n.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},n.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},n.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},n})(),Ee=function(n,e){return Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])},Ee(n,e)};function Ge(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ee(n,e);function i(){this.constructor=n}n.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}var Ve=(function(n){Ge(e,n);function e(i){var t=n.call(this)||this;return t._element=i,t}return e})(Array);function Rt(n){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/n,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Pt(n){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[n]}function ge(n,e,i){i.applyStyles(e,!0);var t=Array.isArray(n)?n:[n],r=t.map(function(o){return i.getTextWidth(o)}).reduce(function(o,d){return Math.max(o,d)},0);return r}function $e(n,e,i,t){var r=e.settings.tableLineWidth,o=e.settings.tableLineColor;n.applyStyles({lineWidth:r,lineColor:o});var d=Ye(r,!1);d&&n.rect(i.x,i.y,e.getWidth(n.pageSize().width),t.y-i.y,d)}function Ye(n,e){var i=n>0,t=e||e===0;return i&&t?"DF":i?"S":t?"F":null}function xe(n,e){var i,t,r,o;if(n=n||e,Array.isArray(n)){if(n.length>=4)return{top:n[0],right:n[1],bottom:n[2],left:n[3]};if(n.length===3)return{top:n[0],right:n[1],bottom:n[2],left:n[1]};if(n.length===2)return{top:n[0],right:n[1],bottom:n[0],left:n[1]};n.length===1?n=n[0]:n=e}return typeof n=="object"?(typeof n.vertical=="number"&&(n.top=n.vertical,n.bottom=n.vertical),typeof n.horizontal=="number"&&(n.right=n.horizontal,n.left=n.horizontal),{left:(i=n.left)!==null&&i!==void 0?i:e,top:(t=n.top)!==null&&t!==void 0?t:e,right:(r=n.right)!==null&&r!==void 0?r:e,bottom:(o=n.bottom)!==null&&o!==void 0?o:e}):(typeof n!="number"&&(n=e),{top:n,right:n,bottom:n,left:n})}function Ke(n,e){var i=xe(e.settings.margin,0);return n.pageSize().width-(i.left+i.right)}function Ot(n,e,i,t,r){var o={},d=1.3333333333333333,c=me(e,function(k){return r.getComputedStyle(k).backgroundColor});c!=null&&(o.fillColor=c);var l=me(e,function(k){return r.getComputedStyle(k).color});l!=null&&(o.textColor=l);var s=Ft(t,i);s&&(o.cellPadding=s);var f="borderTopColor",p=d*i,h=t.borderTopWidth;if(t.borderBottomWidth===h&&t.borderRightWidth===h&&t.borderLeftWidth===h){var x=(parseFloat(h)||0)/p;x&&(o.lineWidth=x)}else o.lineWidth={top:(parseFloat(t.borderTopWidth)||0)/p,right:(parseFloat(t.borderRightWidth)||0)/p,bottom:(parseFloat(t.borderBottomWidth)||0)/p,left:(parseFloat(t.borderLeftWidth)||0)/p},o.lineWidth.top||(o.lineWidth.right?f="borderRightColor":o.lineWidth.bottom?f="borderBottomColor":o.lineWidth.left&&(f="borderLeftColor"));var u=me(e,function(k){return r.getComputedStyle(k)[f]});u!=null&&(o.lineColor=u);var S=["left","right","center","justify"];S.indexOf(t.textAlign)!==-1&&(o.halign=t.textAlign),S=["middle","bottom","top"],S.indexOf(t.verticalAlign)!==-1&&(o.valign=t.verticalAlign);var b=parseInt(t.fontSize||"");isNaN(b)||(o.fontSize=b/d);var I=Nt(t);I&&(o.fontStyle=I);var z=(t.fontFamily||"").toLowerCase();return n.indexOf(z)!==-1&&(o.font=z),o}function Nt(n){var e="";return(n.fontWeight==="bold"||n.fontWeight==="bolder"||parseInt(n.fontWeight)>=700)&&(e="bold"),(n.fontStyle==="italic"||n.fontStyle==="oblique")&&(e+="italic"),e}function me(n,e){var i=Je(n,e);if(!i)return null;var t=i.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!t||!Array.isArray(t))return null;var r=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])],o=parseInt(t[4]);return o===0||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function Je(n,e){var i=e(n);return i==="rgba(0, 0, 0, 0)"||i==="transparent"||i==="initial"||i==="inherit"?n.parentElement==null?null:Je(n.parentElement,e):i}function Ft(n,e){var i=[n.paddingTop,n.paddingRight,n.paddingBottom,n.paddingLeft],t=96/(72/e),r=(parseInt(n.lineHeight)-parseInt(n.fontSize))/e/2,o=i.map(function(c){return parseInt(c||"0")/t}),d=xe(o,0);return r>d.top&&(d.top=r),r>d.bottom&&(d.bottom=r),d}function Ze(n,e,i,t,r){var o,d;t===void 0&&(t=!1),r===void 0&&(r=!1);var c;typeof e=="string"?c=i.document.querySelector(e):c=e;var l=Object.keys(n.getFontList()),s=n.scaleFactor(),f=[],p=[],h=[];if(!c)return console.error("Html table could not be found with input: ",e),{head:f,body:p,foot:h};for(var x=0;x<c.rows.length;x++){var u=c.rows[x],S=(d=(o=u?.parentElement)===null||o===void 0?void 0:o.tagName)===null||d===void 0?void 0:d.toLowerCase(),b=Mt(l,s,i,u,t,r);b&&(S==="thead"?f.push(b):S==="tfoot"?h.push(b):p.push(b))}return{head:f,body:p,foot:h}}function Mt(n,e,i,t,r,o){for(var d=new Ve(t),c=0;c<t.cells.length;c++){var l=t.cells[c],s=i.getComputedStyle(l);if(r||s.display!=="none"){var f=void 0;o&&(f=Ot(n,l,e,s,i)),d.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:f,_element:l,content:Lt(l)})}}var p=i.getComputedStyle(t);if(d.length>0&&(r||p.display!=="none"))return d}function Lt(n){var e=n.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(i){return i.trim()}).join(`
`),e.innerText||e.textContent||""}function kt(n,e,i){for(var t=0,r=[n,e,i];t<r.length;t++){var o=r[t];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function U(n,e,i,t,r){if(n==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(n),d=1;d<arguments.length;d++){var c=arguments[d];if(c!=null)for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(o[l]=c[l])}return o}function Xe(n,e){var i=new ae(n),t=i.getDocumentOptions(),r=i.getGlobalOptions();kt(r,t,e);var o=U({},r,t,e),d;typeof window<"u"&&(d=window);var c=Wt(r,t,e),l=zt(r,t,e),s=Ht(i,o),f=_t(i,o,d);return{id:e.tableId,content:f,hooks:l,styles:c,settings:s}}function Wt(n,e,i){for(var t={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},r=function(l){if(l==="columnStyles"){var s=n[l],f=e[l],p=i[l];t.columnStyles=U({},s,f,p)}else{var h=[n,e,i],x=h.map(function(u){return u[l]||{}});t[l]=U({},x[0],x[1],x[2])}},o=0,d=Object.keys(t);o<d.length;o++){var c=d[o];r(c)}return t}function zt(n,e,i){for(var t=[n,e,i],r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,d=t;o<d.length;o++){var c=d[o];c.didParseCell&&r.didParseCell.push(c.didParseCell),c.willDrawCell&&r.willDrawCell.push(c.willDrawCell),c.didDrawCell&&r.didDrawCell.push(c.didDrawCell),c.willDrawPage&&r.willDrawPage.push(c.willDrawPage),c.didDrawPage&&r.didDrawPage.push(c.didDrawPage)}return r}function Ht(n,e){var i,t,r,o,d,c,l,s,f,p,h,x,u=xe(e.margin,40/n.scaleFactor()),S=(i=Bt(n,e.startY))!==null&&i!==void 0?i:u.top,b;e.showFoot===!0?b="everyPage":e.showFoot===!1?b="never":b=(t=e.showFoot)!==null&&t!==void 0?t:"everyPage";var I;e.showHead===!0?I="everyPage":e.showHead===!1?I="never":I=(r=e.showHead)!==null&&r!==void 0?r:"everyPage";var z=(o=e.useCss)!==null&&o!==void 0?o:!1,k=e.theme||(z?"plain":"striped"),Z=!!e.horizontalPageBreak,V=(d=e.horizontalPageBreakRepeat)!==null&&d!==void 0?d:null;return{includeHiddenHtml:(c=e.includeHiddenHtml)!==null&&c!==void 0?c:!1,useCss:z,theme:k,startY:S,margin:u,pageBreak:(l=e.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(s=e.rowPageBreak)!==null&&s!==void 0?s:"auto",tableWidth:(f=e.tableWidth)!==null&&f!==void 0?f:"auto",showHead:I,showFoot:b,tableLineWidth:(p=e.tableLineWidth)!==null&&p!==void 0?p:0,tableLineColor:(h=e.tableLineColor)!==null&&h!==void 0?h:200,horizontalPageBreak:Z,horizontalPageBreakRepeat:V,horizontalPageBreakBehaviour:(x=e.horizontalPageBreakBehaviour)!==null&&x!==void 0?x:"afterAllRows"}}function Bt(n,e){var i=n.getLastAutoTable(),t=n.scaleFactor(),r=n.pageNumber(),o=!1;if(i&&i.startPageNumber){var d=i.startPageNumber+i.pageNumber-1;o=d===r}return typeof e=="number"?e:(e==null||e===!1)&&o&&i?.finalY!=null?i.finalY+20/t:null}function _t(n,e,i){var t=e.head||[],r=e.body||[],o=e.foot||[];if(e.html){var d=e.includeHiddenHtml;if(i){var c=Ze(n,e.html,i,d,e.useCss)||{};t=c.head||t,r=c.body||t,o=c.foot||t}else console.error("Cannot parse html in non browser environment")}var l=e.columns||Ut(t,r,o);return{columns:l,head:t,body:r,foot:o}}function Ut(n,e,i){var t=n[0]||e[0]||i[0]||[],r=[];return Object.keys(t).filter(function(o){return o!=="_element"}).forEach(function(o){var d=1,c;Array.isArray(t)?c=t[parseInt(o)]:c=t[o],typeof c=="object"&&!Array.isArray(c)&&(d=c?.colSpan||1);for(var l=0;l<d;l++){var s=void 0;Array.isArray(t)?s=r.length:s=o+(l>0?"_".concat(l):"");var f={dataKey:s};r.push(f)}}),r}var Ae=(function(){function n(e,i,t){this.table=i,this.pageNumber=i.pageNumber,this.settings=i.settings,this.cursor=t,this.doc=e.getDocument()}return n})(),Gt=(function(n){Ge(e,n);function e(i,t,r,o,d,c){var l=n.call(this,i,t,c)||this;return l.cell=r,l.row=o,l.column=d,l.section=o.section,l}return e})(Ae),Vt=(function(){function n(e,i){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=i.columns,this.head=i.head,this.body=i.body,this.foot=i.foot}return n.prototype.getHeadHeight=function(e){return this.head.reduce(function(i,t){return i+t.getMaxCellHeight(e)},0)},n.prototype.getFootHeight=function(e){return this.foot.reduce(function(i,t){return i+t.getMaxCellHeight(e)},0)},n.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},n.prototype.callCellHooks=function(e,i,t,r,o,d){for(var c=0,l=i;c<l.length;c++){var s=l[c],f=new Gt(e,this,t,r,o,d),p=s(f)===!1;if(t.text=Array.isArray(t.text)?t.text:[t.text],p)return!1}return!0},n.prototype.callEndPageHooks=function(e,i){e.applyStyles(e.userStyles);for(var t=0,r=this.hooks.didDrawPage;t<r.length;t++){var o=r[t];o(new Ae(e,this,i))}},n.prototype.callWillDrawPageHooks=function(e,i){for(var t=0,r=this.hooks.willDrawPage;t<r.length;t++){var o=r[t];o(new Ae(e,this,i))}},n.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var i=this.columns.reduce(function(r,o){return r+o.wrappedWidth},0);return i}else{var t=this.settings.margin;return e-t.left-t.right}},n})(),Qe=(function(){function n(e,i,t,r,o){o===void 0&&(o=!1),this.height=0,this.raw=e,e instanceof Ve&&(this.raw=e._element,this.element=e._element),this.index=i,this.section=t,this.cells=r,this.spansMultiplePages=o}return n.prototype.getMaxCellHeight=function(e){var i=this;return e.reduce(function(t,r){var o;return Math.max(t,((o=i.cells[r.index])===null||o===void 0?void 0:o.height)||0)},0)},n.prototype.hasRowSpan=function(e){var i=this;return e.filter(function(t){var r=i.cells[t.index];return r?r.rowSpan>1:!1}).length>0},n.prototype.canEntireRowFit=function(e,i){return this.getMaxCellHeight(i)<=e},n.prototype.getMinimumRowHeight=function(e,i){var t=this;return e.reduce(function(r,o){var d=t.cells[o.index];if(!d)return 0;var c=i.getLineHeight(d.styles.fontSize),l=d.padding("vertical"),s=l+c;return s>r?s:r},0)},n})(),qe=(function(){function n(e,i,t){var r;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=i,this.section=t,this.raw=e;var o=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,o=(r=e.content)!==null&&r!==void 0?r:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var d=o!=null?""+o:"",c=/\r\n|\r|\n/g;this.text=d.split(c)}return n.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var i=this.height-this.padding("vertical");e=this.y+i/2+this.padding("top")}var t;if(this.styles.halign==="right")t=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var r=this.width-this.padding("horizontal");t=this.x+r/2+this.padding("left")}else t=this.x+this.padding("left");return{x:t,y:e}},n.prototype.getContentHeight=function(e,i){i===void 0&&(i=1.15);var t=Array.isArray(this.text)?this.text.length:1,r=this.styles.fontSize/e*i,o=t*r+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},n.prototype.padding=function(e){var i=xe(this.styles.cellPadding,0);return e==="vertical"?i.top+i.bottom:e==="horizontal"?i.left+i.right:i[e]},n})(),$t=(function(){function n(e,i,t){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=i,this.index=t}return n.prototype.getMaxCustomCellWidth=function(e){for(var i=0,t=0,r=e.allRows();t<r.length;t++){var o=r[t],d=o.cells[this.index];d&&typeof d.styles.cellWidth=="number"&&(i=Math.max(i,d.styles.cellWidth))}return i},n})();function Yt(n,e){Kt(n,e);var i=[],t=0;e.columns.forEach(function(o){var d=o.getMaxCustomCellWidth(e);d?o.width=d:(o.width=o.wrappedWidth,i.push(o)),t+=o.width});var r=e.getWidth(n.pageSize().width)-t;r&&(r=we(i,r,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),r&&(r=we(i,r,function(o){return o.minWidth})),r=Math.abs(r),!e.settings.horizontalPageBreak&&r>.1/n.scaleFactor()&&(r=r<1?r:Math.round(r),console.log("Of the table content, ".concat(r," units width could not fit page"))),Zt(e),Xt(e,n),Jt(e)}function Kt(n,e){var i=n.scaleFactor(),t=e.settings.horizontalPageBreak,r=Ke(n,e);e.allRows().forEach(function(o){for(var d=0,c=e.columns;d<c.length;d++){var l=c[d],s=o.cells[l.index];if(s){var f=e.hooks.didParseCell;e.callCellHooks(n,f,s,o,l,null);var p=s.padding("horizontal");s.contentWidth=ge(s.text,s.styles,n)+p;var h=ge(s.text.join(" ").split(/[^\S\u00A0]+/),s.styles,n);if(s.minReadableWidth=h+s.padding("horizontal"),typeof s.styles.cellWidth=="number")s.minWidth=s.styles.cellWidth,s.wrappedWidth=s.styles.cellWidth;else if(s.styles.cellWidth==="wrap"||t===!0)s.contentWidth>r?(s.minWidth=r,s.wrappedWidth=r):(s.minWidth=s.contentWidth,s.wrappedWidth=s.contentWidth);else{var x=10/i;s.minWidth=s.styles.minCellWidth||x,s.wrappedWidth=s.contentWidth,s.minWidth>s.wrappedWidth&&(s.wrappedWidth=s.minWidth)}}}}),e.allRows().forEach(function(o){for(var d=0,c=e.columns;d<c.length;d++){var l=c[d],s=o.cells[l.index];if(s&&s.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,s.wrappedWidth),l.minWidth=Math.max(l.minWidth,s.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,s.minReadableWidth);else{var f=e.styles.columnStyles[l.dataKey]||e.styles.columnStyles[l.index]||{},p=f.cellWidth||f.minCellWidth;p&&typeof p=="number"&&(l.minWidth=p,l.wrappedWidth=p)}s&&(s.colSpan>1&&!l.minWidth&&(l.minWidth=s.minWidth),s.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=s.minWidth))}})}function we(n,e,i){for(var t=e,r=n.reduce(function(x,u){return x+u.wrappedWidth},0),o=0;o<n.length;o++){var d=n[o],c=d.wrappedWidth/r,l=t*c,s=d.width+l,f=i(d),p=s<f?f:s;e-=p-d.width,d.width=p}if(e=Math.round(e*1e10)/1e10,e){var h=n.filter(function(x){return e<0?x.width>i(x):!0});h.length&&(e=we(h,e,i))}return e}function Jt(n){for(var e={},i=1,t=n.allRows(),r=0;r<t.length;r++)for(var o=t[r],d=0,c=n.columns;d<c.length;d++){var l=c[d],s=e[l.index];if(i>1)i--,delete o.cells[l.index];else if(s)s.cell.height+=o.height,i=s.cell.colSpan,delete o.cells[l.index],s.left--,s.left<=1&&delete e[l.index];else{var f=o.cells[l.index];if(!f)continue;if(f.height=o.height,f.rowSpan>1){var p=t.length-r,h=f.rowSpan>p?p:f.rowSpan;e[l.index]={cell:f,left:h,row:o}}}}}function Zt(n){for(var e=n.allRows(),i=0;i<e.length;i++)for(var t=e[i],r=null,o=0,d=0,c=0;c<n.columns.length;c++){var l=n.columns[c];if(d-=1,d>1&&n.columns[c+1])o+=l.width,delete t.cells[l.index];else if(r){var s=r;delete t.cells[l.index],r=null,s.width=l.width+o}else{var s=t.cells[l.index];if(!s)continue;if(d=s.colSpan,o=0,s.colSpan>1){r=s,o+=l.width;continue}s.width=l.width+o}}}function Xt(n,e){for(var i={count:0,height:0},t=0,r=n.allRows();t<r.length;t++){for(var o=r[t],d=0,c=n.columns;d<c.length;d++){var l=c[d],s=o.cells[l.index];if(s){e.applyStyles(s.styles,!0);var f=s.width-s.padding("horizontal");if(s.styles.overflow==="linebreak")s.text=e.splitTextToSize(s.text,f+1/e.scaleFactor(),{fontSize:s.styles.fontSize});else if(s.styles.overflow==="ellipsize")s.text=Oe(s.text,f,s.styles,e,"...");else if(s.styles.overflow==="hidden")s.text=Oe(s.text,f,s.styles,e,"");else if(typeof s.styles.overflow=="function"){var p=s.styles.overflow(s.text,f);typeof p=="string"?s.text=[p]:s.text=p}s.contentHeight=s.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var h=s.contentHeight/s.rowSpan;s.rowSpan>1&&i.count*i.height<h*s.rowSpan?i={height:h,count:s.rowSpan}:i&&i.count>0&&i.height>h&&(h=i.height),h>o.height&&(o.height=h)}}i.count--}}function Oe(n,e,i,t,r){return n.map(function(o){return Qt(o,e,i,t,r)})}function Qt(n,e,i,t,r){var o=1e4*t.scaleFactor();if(e=Math.ceil(e*o)/o,e>=ge(n,i,t))return n;for(;e<ge(n+r,i,t)&&!(n.length<=1);)n=n.substring(0,n.length-1);return n.trim()+r}function et(n,e){var i=new ae(n),t=qt(e,i.scaleFactor()),r=new Vt(e,t);return Yt(i,r),i.applyStyles(i.userStyles),r}function qt(n,e){var i=n.content,t=tn(i.columns);if(i.head.length===0){var r=Ne(t,"head");r&&i.head.push(r)}if(i.foot.length===0){var r=Ne(t,"foot");r&&i.foot.push(r)}var o=n.settings.theme,d=n.styles;return{columns:t,head:be("head",i.head,t,d,o,e),body:be("body",i.body,t,d,o,e),foot:be("foot",i.foot,t,d,o,e)}}function be(n,e,i,t,r,o){var d={},c=e.map(function(l,s){for(var f=0,p={},h=0,x=0,u=0,S=i;u<S.length;u++){var b=S[u];if(d[b.index]==null||d[b.index].left===0)if(x===0){var I=void 0;Array.isArray(l)?I=l[b.index-h-f]:I=l[b.dataKey];var z={};typeof I=="object"&&!Array.isArray(I)&&(z=I?.styles||{});var k=nn(n,b,s,r,t,o,z),Z=new qe(I,k,n);p[b.dataKey]=Z,p[b.index]=Z,x=Z.colSpan-1,d[b.index]={left:Z.rowSpan-1,times:x}}else x--,h++;else d[b.index].left--,x=d[b.index].times,f++}return new Qe(l,s,n,p)});return c}function Ne(n,e){var i={};return n.forEach(function(t){if(t.raw!=null){var r=en(e,t.raw);r!=null&&(i[t.dataKey]=r)}}),Object.keys(i).length>0?i:null}function en(n,e){if(n==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(n==="foot"&&typeof e=="object")return e.footer;return null}function tn(n){return n.map(function(e,i){var t,r;return typeof e=="object"?r=(t=e.dataKey)!==null&&t!==void 0?t:i:r=i,new $t(r,e,i)})}function nn(n,e,i,t,r,o,d){var c=Pt(t),l;n==="head"?l=r.headStyles:n==="body"?l=r.bodyStyles:n==="foot"&&(l=r.footStyles);var s=U({},c.table,c[n],r.styles,l),f=r.columnStyles[e.dataKey]||r.columnStyles[e.index]||{},p=n==="body"?f:{},h=n==="body"&&i%2===0?U({},c.alternateRow,r.alternateRowStyles):{},x=Rt(o),u=U({},x,s,h,p);return U(u,d)}function rn(n,e,i){var t;i===void 0&&(i={});var r=Ke(n,e),o=new Map,d=[],c=[],l=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?l=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(l=[e.settings.horizontalPageBreakRepeat]),l.forEach(function(h){var x=e.columns.find(function(u){return u.dataKey===h||u.index===h});x&&!o.has(x.index)&&(o.set(x.index,!0),d.push(x.index),c.push(e.columns[x.index]),r-=x.wrappedWidth)});for(var s=!0,f=(t=i?.start)!==null&&t!==void 0?t:0;f<e.columns.length;){if(o.has(f)){f++;continue}var p=e.columns[f].wrappedWidth;if(s||r>=p)s=!1,d.push(f),c.push(e.columns[f]),r-=p;else break;f++}return{colIndexes:d,columns:c,lastIndex:f-1}}function on(n,e){for(var i=[],t=0;t<e.columns.length;t++){var r=rn(n,e,{start:t});r.columns.length&&(i.push(r),t=r.lastIndex)}return i}function tt(n,e){var i=e.settings,t=i.startY,r=i.margin,o={x:r.left,y:t},d=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),c=t+r.bottom+d;if(i.pageBreak==="avoid"){var l=e.body,s=l.reduce(function(h,x){return h+x.height},0);c+=s}var f=new ae(n);(i.pageBreak==="always"||i.startY!=null&&c>f.pageSize().height)&&(it(f),o.y=r.top),e.callWillDrawPageHooks(f,o);var p=U({},o);e.startPageNumber=f.pageNumber(),i.horizontalPageBreak?an(f,e,p,o):(f.applyStyles(f.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(h){return G(f,e,h,o,e.columns)}),f.applyStyles(f.userStyles),e.body.forEach(function(h,x){var u=x===e.body.length-1;ue(f,e,h,u,p,o,e.columns)}),f.applyStyles(f.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(h){return G(f,e,h,o,e.columns)})),$e(f,e,p,o),e.callEndPageHooks(f,o),e.finalY=o.y,n.lastAutoTable=e,f.applyStyles(f.userStyles)}function an(n,e,i,t){var r=on(n,e),o=e.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")r.forEach(function(s,f){n.applyStyles(n.userStyles),f>0?ce(n,e,i,t,s.columns,!0):Fe(n,e,t,s.columns),sn(n,e,i,t,s.columns),Se(n,e,t,s.columns)});else for(var d=-1,c=r[0],l=function(){var s=d;if(c){n.applyStyles(n.userStyles);var f=c.columns;d>=0?ce(n,e,i,t,f,!0):Fe(n,e,t,f),s=Me(n,e,d+1,t,f),Se(n,e,t,f)}var p=s-d;r.slice(1).forEach(function(h){n.applyStyles(n.userStyles),ce(n,e,i,t,h.columns,!0),Me(n,e,d+1,t,h.columns,p),Se(n,e,t,h.columns)}),d=s};d<e.body.length-1;)l()}function Fe(n,e,i,t){var r=e.settings;n.applyStyles(n.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&e.head.forEach(function(o){return G(n,e,o,i,t)})}function sn(n,e,i,t,r){n.applyStyles(n.userStyles),e.body.forEach(function(o,d){var c=d===e.body.length-1;ue(n,e,o,c,i,t,r)})}function Me(n,e,i,t,r,o){n.applyStyles(n.userStyles),o=o??e.body.length;var d=Math.min(i+o,e.body.length),c=-1;return e.body.slice(i,d).forEach(function(l,s){var f=i+s===e.body.length-1,p=nt(n,e,f,t);l.canEntireRowFit(p,r)&&(G(n,e,l,t,r),c=i+s)}),c}function Se(n,e,i,t){var r=e.settings;n.applyStyles(n.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&e.foot.forEach(function(o){return G(n,e,o,i,t)})}function ln(n,e,i){var t=i.getLineHeight(n.styles.fontSize),r=n.padding("vertical"),o=Math.floor((e-r)/t);return Math.max(0,o)}function dn(n,e,i,t){var r={};n.spansMultiplePages=!0,n.height=0;for(var o=0,d=0,c=i.columns;d<c.length;d++){var l=c[d],s=n.cells[l.index];if(s){Array.isArray(s.text)||(s.text=[s.text]);var f=new qe(s.raw,s.styles,s.section);f=U(f,s),f.text=[];var p=ln(s,e,t);s.text.length>p&&(f.text=s.text.splice(p,s.text.length));var h=t.scaleFactor(),x=t.getLineHeightFactor();s.contentHeight=s.getContentHeight(h,x),s.contentHeight>=e&&(s.contentHeight=e,f.styles.minCellHeight-=e),s.contentHeight>n.height&&(n.height=s.contentHeight),f.contentHeight=f.getContentHeight(h,x),f.contentHeight>o&&(o=f.contentHeight),r[l.index]=f}}var u=new Qe(n.raw,-1,n.section,r,!0);u.height=o;for(var S=0,b=i.columns;S<b.length;S++){var l=b[S],f=u.cells[l.index];f&&(f.height=u.height);var s=n.cells[l.index];s&&(s.height=n.height)}return u}function cn(n,e,i,t){var r=n.pageSize().height,o=t.settings.margin,d=o.top+o.bottom,c=r-d;e.section==="body"&&(c-=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns));var l=e.getMinimumRowHeight(t.columns,n),s=l<i;if(l>c)return console.log("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!s)return!1;var f=e.hasRowSpan(t.columns),p=e.getMaxCellHeight(t.columns)>c;return p?(f&&console.log("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||t.settings.rowPageBreak==="avoid")}function ue(n,e,i,t,r,o,d){var c=nt(n,e,t,o);if(i.canEntireRowFit(c,d))G(n,e,i,o,d);else if(cn(n,i,c,e)){var l=dn(i,c,e,n);G(n,e,i,o,d),ce(n,e,r,o,d),ue(n,e,l,t,r,o,d)}else ce(n,e,r,o,d),ue(n,e,i,t,r,o,d)}function G(n,e,i,t,r){t.x=e.settings.margin.left;for(var o=0,d=r;o<d.length;o++){var c=d[o],l=i.cells[c.index];if(!l){t.x+=c.width;continue}n.applyStyles(l.styles),l.x=t.x,l.y=t.y;var s=e.callCellHooks(n,e.hooks.willDrawCell,l,i,c,t);if(s===!1){t.x+=c.width;continue}fn(n,l,t);var f=l.getTextPos();Ue(l.text,f.x,f.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},n.getDocument()),e.callCellHooks(n,e.hooks.didDrawCell,l,i,c,t),t.x+=c.width}t.y+=i.height}function fn(n,e,i){var t=e.styles;if(n.getDocument().setFillColor(n.getDocument().getFillColor()),typeof t.lineWidth=="number"){var r=Ye(t.lineWidth,t.fillColor);r&&n.rect(e.x,i.y,e.width,e.height,r)}else typeof t.lineWidth=="object"&&(t.fillColor&&n.rect(e.x,i.y,e.width,e.height,"F"),hn(n,e,i,t.lineWidth))}function hn(n,e,i,t){var r,o,d,c;t.top&&(r=i.x,o=i.y,d=i.x+e.width,c=i.y,t.right&&(d+=.5*t.right),t.left&&(r-=.5*t.left),l(t.top,r,o,d,c)),t.bottom&&(r=i.x,o=i.y+e.height,d=i.x+e.width,c=i.y+e.height,t.right&&(d+=.5*t.right),t.left&&(r-=.5*t.left),l(t.bottom,r,o,d,c)),t.left&&(r=i.x,o=i.y,d=i.x,c=i.y+e.height,t.top&&(o-=.5*t.top),t.bottom&&(c+=.5*t.bottom),l(t.left,r,o,d,c)),t.right&&(r=i.x+e.width,o=i.y,d=i.x+e.width,c=i.y+e.height,t.top&&(o-=.5*t.top),t.bottom&&(c+=.5*t.bottom),l(t.right,r,o,d,c));function l(s,f,p,h,x){n.getDocument().setLineWidth(s),n.getDocument().line(f,p,h,x,"S")}}function nt(n,e,i,t){var r=e.settings.margin.bottom,o=e.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&i)&&(r+=e.getFootHeight(e.columns)),n.pageSize().height-t.y-r}function ce(n,e,i,t,r,o){r===void 0&&(r=[]),o===void 0&&(o=!1),n.applyStyles(n.userStyles),e.settings.showFoot==="everyPage"&&!o&&e.foot.forEach(function(c){return G(n,e,c,t,r)}),e.callEndPageHooks(n,t);var d=e.settings.margin;$e(n,e,i,t),it(n),e.pageNumber++,t.x=d.left,t.y=d.top,i.y=d.top,e.callWillDrawPageHooks(n,t),e.settings.showHead==="everyPage"&&(e.head.forEach(function(c){return G(n,e,c,t,r)}),n.applyStyles(n.userStyles))}function it(n){var e=n.pageNumber();n.setPage(e+1);var i=n.pageNumber();return i===e?(n.addPage(),!0):!1}function pn(n){n.API.autoTable=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var t=e[0],r=Xe(this,t),o=et(this,r);return tt(this,o),this},n.API.lastAutoTable=!1,n.API.autoTableText=function(e,i,t,r){Ue(e,i,t,r,this)},n.API.autoTableSetDefaults=function(e){return ae.setDefaults(e,this),this},n.autoTableSetDefaults=function(e,i){ae.setDefaults(e,i)},n.API.autoTableHtmlToJson=function(e,i){var t;if(i===void 0&&(i=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var r=new ae(this),o=Ze(r,e,window,i,!1),d=o.head,c=o.body,l=((t=d[0])===null||t===void 0?void 0:t.map(function(s){return s.content}))||[];return{columns:l,rows:c,data:c}}}var Ce;function Le(n,e){var i=Xe(n,e),t=et(n,i);tt(n,t)}try{if(typeof window<"u"&&window){var ke=window,We=ke.jsPDF||((Ce=ke.jspdf)===null||Ce===void 0?void 0:Ce.jsPDF);We&&pn(We)}}catch(n){console.error("Could not apply autoTable plugin",n)}const gn=(n,e,i)=>{const t=new mt;t.setFillColor(5,10,16),t.rect(0,0,210,40,"F"),t.setTextColor(0,240,255),t.setFontSize(22),t.setFont("helvetica","bold"),t.text("TESO FINANCIAL ENGINE",15,20),t.setFontSize(10),t.setTextColor(200,200,200),t.text("CERTIFICADO DE RESILIENCIA FINANCIERA",15,30),t.setTextColor(255,255,255),t.text(`FECHA: ${new Date().toLocaleDateString()}`,160,20),t.text(`ID: ${Math.floor(Math.random()*1e5)}`,160,26),t.setTextColor(0,0,0),t.setFontSize(14),t.text("1. ESCENARIO SIMULADO (WAR ROOM)",15,55),Le(t,{startY:60,head:[["PARAMETRO","VALOR CONFIGURADO","IMPACTO"]],body:[["D√≠as Cartera (CxC)",`${n.cxcDays} D√≠as`,"Ciclo de Cobro"],["Frecuencia N√≥mina (CxP)",`${n.cxpFreq} D√≠as`,"Presi√≥n de Caja"],["Factor Crecimiento",`${n.growth}x`,"Volumen Operativo"]],theme:"grid",headStyles:{fillColor:[50,50,50]}});const r=t.lastAutoTable.finalY+15;t.setFontSize(14),t.text("2. RESULTADO DE ESTR√âS",15,r);const o=e.status==="INSOLVENT"?[239,68,68]:[5,150,105];t.setFillColor(...o),t.rect(15,r+5,180,25,"F"),t.setTextColor(255,255,255),t.setFontSize(16),t.setFont("helvetica","bold"),t.text(`ESTADO: ${e.status}`,25,r+18),t.setFontSize(12),t.setFont("helvetica","normal"),t.text(`CASH RUNWAY: ${e.runway}`,120,r+18),t.setTextColor(0,0,0);const d=r+40;t.text("3. M√âTRICAS CLAVE",15,d),Le(t,{startY:d+5,body:[["Cash Flow M√≠nimo",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(e.minCash)],["D√≠a de Quiebra Est.",e.insolvencyDay||"N/A"],["Margen Operativo",`${i.marginPercent}%`],["Ingresos Proyectados",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(i.totalRevenue)]],theme:"striped"}),t.setFontSize(8),t.setTextColor(100,100,100);const c=t.internal.pageSize.height;return t.text("Este documento es generado autom√°ticamente por la IA de Teso.",15,c-15),t.text("La validez de este certificado depende de la integridad de los datos de entrada.",15,c-10),t},un=async(n,e,i)=>{try{await fetch("https://teso-api-dev.fly.dev/api/audit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:n,action:e,details:i})}),console.log(`[AUDIT] Logged: ${e}`)}catch(t){console.warn("[AUDIT] Failed to log event",t)}},de=({variant:n="primary",size:e="md",icon:i,className:t="",children:r,style:o={},...d})=>{const c={fontFamily:"var(--font-main)",fontWeight:"bold",cursor:"pointer",border:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"var(--spacing-sm)",transition:"all 0.2s ease",textTransform:"uppercase",letterSpacing:"0.5px",...o},l={primary:{background:"var(--color-primary)",color:"#000",borderRadius:"var(--radius-sm)",boxShadow:"var(--shadow-glow-blue)"},danger:{background:"transparent",border:"1px solid var(--color-kpi-danger)",color:"var(--color-kpi-danger)",borderRadius:"var(--radius-lg)",boxShadow:"none"},dangerSolid:{background:"var(--color-kpi-danger)",color:"#fff",borderRadius:"var(--radius-sm)",boxShadow:"var(--shadow-glow-red)"},glass:{background:"rgba(15, 23, 42, 0.6)",border:"1px solid var(--color-border-subtle)",color:"#ffffff",borderRadius:"var(--radius-md)",backdropFilter:"blur(4px)",textShadow:"0 2px 4px #000000"},ghost:{background:"transparent",color:"var(--color-text-secondary)",border:"none",padding:0},active:{background:"var(--color-kpi-positive)",color:"#000",borderRadius:"var(--radius-sm)"}},s={sm:{padding:"4px 10px",fontSize:"var(--text-xs)",borderRadius:n==="danger"?"var(--radius-lg)":"var(--radius-sm)"},md:{padding:"8px 16px",fontSize:"var(--text-sm)"},lg:{padding:"12px 24px",fontSize:"var(--text-md)"}},f={...c,...l[n],...s[e],...o};return a.jsxs("button",{style:f,className:`teso-btn teso-btn-${n} ${t}`,...d,children:[i&&a.jsx("span",{style:{display:"flex",alignItems:"center"},children:i}),r]})},he=6.2442,pe=-75.5812;console.log("‚úÖ CoreOperativo Loaded. Center:",he,pe);const xn=({p:n})=>a.jsx(fe,{position:[n.lat,n.lng],icon:Dt(n.heading),zIndexOffset:1e3,eventHandlers:{mouseover:e=>e.target.openTooltip(),mouseout:e=>e.target.closeTooltip()},children:a.jsx(Tt,{direction:"top",offset:[0,-10],opacity:1,sticky:!0,children:a.jsxs("div",{style:{background:"rgba(15, 23, 42, 0.95)",border:"1px solid #334155",borderRadius:"6px",padding:"10px",minWidth:"160px",color:"#fff",boxShadow:"0 10px 20px rgba(0,0,0,0.5)",fontFamily:"sans-serif"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #334155",paddingBottom:"6px",marginBottom:"6px"},children:[a.jsx("span",{style:{fontWeight:"900",color:"#38bdf8",fontSize:"0.9rem"},children:n.id}),a.jsx("span",{style:{fontSize:"0.6rem",background:"#10b981",padding:"2px 6px",borderRadius:"10px",color:"#fff",fontWeight:"bold",border:"1px solid #059669"},children:"IN FLIGHT"})]}),a.jsxs("div",{style:{fontSize:"0.75rem",lineHeight:"1.5",color:"#e2e8f0"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"2px"},children:[a.jsx("span",{style:{color:"#94a3b8"},children:"Ruta:"}),a.jsxs("span",{style:{fontWeight:"bold"},children:[n.from," ‚ûî MDE"]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[a.jsxs("span",{children:["üì° ",n.alt.toLocaleString()," ft"]}),a.jsxs("span",{children:["üöÄ ",n.spd," kts"]})]}),a.jsxs("div",{style:{marginTop:"6px",paddingTop:"6px",borderTop:"1px solid #334155",color:"#94a3b8",fontSize:"0.7rem",display:"flex",alignItems:"center",gap:"4px"},children:[a.jsx("span",{children:"‚úàÔ∏è"})," ",n.airline," Airlines ‚Ä¢ B737"]})]})]})})}),ze=(n,e)=>{const i=["AA","AV","LA","CM","NK","IB","DL","AM"],t=["MIA","MAD","BOG","PTY","JFK","SCL","LIM","MEX"];let r,o,d,c;!n||!n.getSouth||!n.isValid()?(r=6,o=6.4,d=-75.7,c=-75.3):(r=n.getSouth(),o=n.getNorth(),d=n.getWest(),c=n.getEast());const l=e&&typeof e.lat=="number"?e:{lat:6.2442,lng:-75.5812},s=o-r,f=c-d,p=s*.8,h=f*.8,x=Math.floor(Math.random()*4);let u,S;x===0?(u=o+p,S=d+Math.random()*f):x===1?(u=r-p,S=d+Math.random()*f):x===2?(u=r+Math.random()*s,S=d-h):(u=r+Math.random()*s,S=c+h);const b=l.lat+(Math.random()-.5)*(s*.3),I=l.lng+(Math.random()-.5)*(f*.3),z=Math.atan2(I-S,b-u)*(180/Math.PI),k=s*.0015+Math.random()*(s*.001);return{id:`${i[Math.floor(Math.random()*i.length)]}${Math.floor(100+Math.random()*900)}`,airline:i[Math.floor(Math.random()*i.length)],from:t[Math.floor(Math.random()*t.length)],lat:u,lng:S,heading:z,speed:k,alt:1e4+Math.floor(Math.random()*5e3),spd:300+Math.floor(Math.random()*200)}},vn=({setPlanes:n})=>{const e=Be();return y.useEffect(()=>{if(!e)return;const t=setInterval(()=>{try{if(!e||!e._leaflet_id)return;const r=e.getBounds(),o=e.getCenter(),d=r.pad(2);n(c=>{let l=[...c];if(l.length<15)for(;l.length<15;)console.log("‚úàÔ∏è Spawning New Plane..."),l.push(ze(r,o));return l.map(s=>{const f=s.lat+Math.cos(s.heading*Math.PI/180)*s.speed,p=s.lng+Math.sin(s.heading*Math.PI/180)*s.speed;return d.contains([f,p])?{...s,lat:f,lng:p}:ze(r,o)})})}catch{}},80);return()=>clearInterval(t)},[e,n]),null};function yn({onClose:n,onHome:e,command:i,simulationData:t,activeLayers:r}){const[o,d]=y.useState([]),[c,l]=y.useState([]),[s,f]=y.useState([]);y.useEffect(()=>{if(t&&t.services){const x=t.services.slice(0,15).map((u,S)=>({id:u.plate||`V-0${S+10}`,lat:u.lat||he+(Math.random()-.5)*.05,lng:u.lng||pe+(Math.random()-.5)*.05,status:u.status==="COMPLETED"?"ACTIVE":"IDLE",speed:Math.floor(Math.random()*60)+20,target:null,driver:u.driver_name}));d(x)}else d(Array.from({length:15}).map((h,x)=>({id:`V-0${x+10}`,lat:he+(Math.random()-.5)*.06,lng:pe+(Math.random()-.5)*.06,status:"ACTIVE",speed:30})))},[t]),y.useEffect(()=>{(i?.type||i)==="DISPATCH_WAVE"&&(d(x=>x.map(u=>({...u,status:"DISPATCHED",target:{lat:u.lat+(Math.random()-.5)*.02,lng:u.lng+(Math.random()-.5)*.02},speed:Math.floor(Math.random()*40)+60}))),console.log("üåä DISPATCH WAVE EXECUTED: Units Mobilized."))},[i]);const p=({cmd:h})=>{const x=Be();return y.useEffect(()=>{h&&h.type==="FLY_TO"&&h.payload&&(console.log("‚úàÔ∏è FLYING TO:",h.payload),x.flyTo([h.payload.lat,h.payload.lng],15,{duration:2,easeLinearity:.25}),x.openPopup(wt.popup().setLatLng([h.payload.lat,h.payload.lng]).setContent(`Target: ${h.payload.id||"Location"}`)))},[h,x]),null};return y.useEffect(()=>{const h=setInterval(()=>{d(x=>x.map(u=>u.status==="ACTIVE"||u.status==="DISPATCHED"?{...u,lat:u.lat+(Math.random()-.5)*.0015,lng:u.lng+(Math.random()-.5)*.0015,speed:Math.max(20,Math.floor(Math.random()*70))}:u))},1e3);return()=>clearInterval(h)},[]),y.useEffect(()=>{console.log("‚úàÔ∏è [CoreOperativo] Active Planes:",s.length),s.length>0&&console.log("‚úàÔ∏è [CoreOperativo] Sample Plane:",s[0])},[s]),a.jsx("div",{style:{position:"relative",width:"100%",height:"100%"},children:a.jsxs(bt,{center:[he,pe],zoom:13,style:{height:"100%",width:"100%"},zoomControl:!1,attributionControl:!1,children:[a.jsx(St,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),a.jsx(p,{cmd:i}),a.jsx(vn,{setPlanes:f}),(!r||r.includes("FLEET"))&&o.map(h=>a.jsx(fe,{position:[h.lat,h.lng],icon:Ct,children:a.jsx(Re,{children:a.jsx("strong",{children:h.id})})},h.id)),(!r||r.includes("JOBS"))&&c.map(h=>a.jsx(fe,{position:[h.lat,h.lng],icon:Et},h.id)),[{id:"MDE",lat:6.17,lng:-75.43,code:"JMC"},{id:"EOH",lat:6.22,lng:-75.59,code:"EOH"}].map(h=>a.jsx(fe,{position:[h.lat,h.lng],icon:At(h.code),children:a.jsx(Re,{children:h.code})},h.id)),s.map(h=>a.jsx(xn,{p:h,isSelected:!1},h.id))]})})}function rt({activeTab:n,onTabChange:e}){const i=[{id:"FLOTA",icon:"üöô",label:"FLOTA"},{id:"ORDENES",icon:"üì¶",label:"ORDENES"},{id:"VUELOS",icon:"‚úàÔ∏è",label:"VUELOS"},{id:"CLIENTES",icon:"üè¢",label:"CLIENTES"},{id:"AGENDA",icon:"üìÖ",label:"AGENDA"},{id:"FINANZAS",icon:"üí∞",label:"FINANZAS"},{id:"MERCADO",icon:"üì¢",label:"MERCADO"},{id:"CORE_V4",icon:"üîã",label:"CORE v4.8 LIVE"},{id:"ARTEFACTO",icon:"üß¨",label:"LHU ARTEFACT"}];return a.jsx("div",{style:{display:"flex",justifyContent:"center",flexWrap:"wrap",gap:"6px",padding:"5px"},children:i.map(t=>a.jsxs("button",{onClick:()=>e(t.id),style:{background:n===t.id?"linear-gradient(180deg, rgba(6, 182, 212, 0.25) 0%, rgba(8, 145, 178, 0.05) 100%)":"linear-gradient(180deg, rgba(71, 85, 105, 0.2) 0%, rgba(15, 23, 42, 0.4) 100%)",backdropFilter:"blur(8px)",border:n===t.id?"1px solid #06b6d4":"1px solid rgba(255, 255, 255, 0.1)",color:n===t.id?"#00ffff":"#ffffff",padding:"6px 12px",borderRadius:"12px",display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",fontSize:"0.75rem",fontWeight:"900",textShadow:"0 2px 4px #000000, 0 0 2px #000000",transition:"all 0.2s",boxShadow:n===t.id?"0 0 15px rgba(6, 182, 212, 0.3)":"0 2px 4px rgba(0,0,0,0.2)"},children:[a.jsx("span",{children:t.icon}),a.jsx("span",{children:t.label})]},t.id))})}const mn=_e.lazy(()=>jt(()=>import("./GeminiConsultantArtifact.Ds9Fbn2i.js"),__vite__mapDeps([0,1,2]))),bn=({activeLayers:n,onToggle:e})=>{const i=t=>{if(t.id==="C_GIT")return window.open("https://github.com/GuillermoHoyos/teso_core","_blank");if(t.id==="PITCH")return window.dispatchEvent(new Event("SHOW_PITCH"));if(t.id==="WHATSAPP")return window.open("https://wa.me/573001234567?text=Hola%20TESO%20AI","_blank");e(t.id)};return a.jsx("div",{style:{position:"absolute",top:"75px",left:"20px",bottom:"100px",display:"flex",flexDirection:"column",gap:"8px",zIndex:400,overflowY:"auto",scrollbarWidth:"none"},children:[{id:"RADAR",label:"RADAR JMC",icon:"üì°",color:"#a855f7"},{id:"VISION",label:"VISI√ìN IA",icon:"üß†",color:"#ec4899"},{id:"OPTIMIZE",label:"OPTIMIZE",icon:"üìà",color:"#f59e0b"},{id:"JOBS",label:"PEDIDOS",icon:"üî•",color:"#ef4444"},{id:"FLEET",label:"FLOTA V4",icon:"üöô",color:"#39FF14"},{id:"PITCH",label:"PITCH DECK",icon:"üì¢",color:"#ec4899"},{id:"WHATSAPP",label:"WHATSAPP",icon:"üí¨",color:"#22c55e"},{id:"C_GIT",label:"SOURCE GIT",icon:"üëæ",color:"#64748b"}].map((t,r)=>{const o=n.includes(t.id);return a.jsxs("div",{onClick:()=>i(t),style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",opacity:o||["PITCH","WHATSAPP","C_GIT"].includes(t.id)?1:.8,transition:"all 0.2s",background:o?"linear-gradient(90deg, rgba(6, 182, 212, 0.25) 0%, rgba(8, 145, 178, 0.05) 100%)":"rgba(15, 23, 42, 0.5)",backdropFilter:"blur(8px)",border:o?`1px solid ${t.color}`:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"10px",padding:"6px 10px",boxShadow:"0 2px 4px rgba(0,0,0,0.2)",width:"fit-content",marginBottom:"6px"},children:[a.jsx("div",{style:{fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center",filter:`drop-shadow(0 0 5px ${t.color})`},children:t.icon}),a.jsx("div",{style:{color:"#fff",fontSize:"0.65rem",fontWeight:"bold",letterSpacing:"0.5px",fontFamily:"var(--font-main)",textShadow:"0 2px 4px #000"},children:t.label})]},r)})})},Sn=({simulationData:n,activeView:e,onDispatch:i})=>{const[t,r]=y.useState(null),[o,d]=y.useState(null);y.useEffect(()=>{const l=async()=>{try{const h=await(await fetch("https://teso-api-dev.fly.dev/api/strategic-cycle",{method:"POST"})).json();r(h)}catch{}};l();const s=setInterval(l,1e4);return()=>clearInterval(s)},[]);const c=()=>{switch(e){case"FINANZAS":return a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[a.jsxs("div",{style:{background:"rgba(6, 182, 212, 0.1)",border:"1px solid #06b6d4",padding:"15px",borderRadius:"8px"},children:[a.jsx("div",{style:{fontSize:"0.8rem",color:"#06b6d4",marginBottom:"5px"},children:"INGRESOS HOY"}),a.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"bold",color:"#fff"},children:"$12.5M"}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#39FF14"},children:"‚ñ≤ 15% vs Ayer"})]}),a.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid #ef4444",padding:"15px",borderRadius:"8px"},children:[a.jsx("div",{style:{fontSize:"0.8rem",color:"#ef4444",marginBottom:"5px"},children:"COSTOS OPERATIVOS"}),a.jsx("div",{style:{fontSize:"1.8rem",fontWeight:"bold",color:"#fff"},children:"$8.2M"}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#ef4444"},children:"‚ñº 5% Optimizado"})]}),a.jsx("div",{style:{height:"150px",background:"rgba(0,0,0,0.3)",borderRadius:"8px",padding:"10px",display:"flex",alignItems:"flex-end",justifyContent:"space-between"},children:[40,60,45,80,55,70,90].map((l,s)=>a.jsx("div",{style:{width:"10%",height:`${l}%`,background:s===6?"#39FF14":"#334155",borderRadius:"4px 4px 0 0"}},s))}),a.jsx("button",{style:{background:"#06b6d4",border:"none",padding:"10px",borderRadius:"4px",fontWeight:"bold",cursor:"pointer"},children:"DESCARGAR REPORTE"})]});case"MERCADO":return a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[a.jsx("div",{style:{color:"#94a3b8",fontSize:"0.8rem",fontWeight:"bold"},children:"TOP CLIENTES"}),["ARGOS","NUTRESA","BANCOLOMBIA","SURA"].map((l,s)=>a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px",background:"rgba(255,255,255,0.03)",borderRadius:"6px"},children:[a.jsx("span",{style:{color:"#fff"},children:l}),a.jsxs("span",{style:{color:"#f59e0b"},children:[40-s*5,"% Share"]})]},s)),a.jsx("div",{style:{marginTop:"20px",color:"#94a3b8",fontSize:"0.8rem",fontWeight:"bold"},children:"CAMPA√ëAS ACTIVAS"}),a.jsxs("div",{style:{padding:"10px",background:"rgba(168, 85, 247, 0.1)",border:"1px solid #a855f7",borderRadius:"6px"},children:[a.jsx("div",{style:{color:"#a855f7",fontWeight:"bold"},children:"RETORNO EJECUTIVOS"}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#fff",marginTop:"5px"},children:"Impacto: 1,200 Usuarios"})]})]});case"ORDENES":return a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:n?.services?.slice(0,50).map((l,s)=>a.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:"12px",background:"rgba(255,255,255,0.03)",borderLeft:l.status==="completed"?"3px solid #39FF14":"3px solid #f59e0b",borderRadius:"6px",marginBottom:"8px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px",alignItems:"center"},children:[a.jsx("span",{style:{color:"#fff",fontWeight:"bold",fontSize:"0.95rem",letterSpacing:"0.5px"},children:l.company||l.client||l.paxName||l.clientId||"Cliente Corporativo"}),a.jsx("span",{style:{color:"#bef264",fontSize:"0.75rem",fontWeight:"bold",background:"rgba(190, 242, 100, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:l.time||"PEND"})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("span",{style:{color:"#94a3b8",fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"5px"},children:[a.jsxs("span",{style:{color:"#64748b"},children:["#",l.id]}),a.jsx("span",{children:"‚Ä¢"}),a.jsx("span",{children:l.route||"Zona Metropolitana"})]}),a.jsx("span",{style:{color:l.status==="completed"?"#39FF14":"#f59e0b",fontSize:"0.7rem",fontWeight:"bold",textTransform:"uppercase"},children:l.status==="completed"?"FINALIZADO":"EN CURSO"})]})]},s))||a.jsx("div",{style:{color:"#64748b",padding:"20px",textAlign:"center"},children:"No hay ordenes activas en este momento."})});default:return a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{marginBottom:"20px",display:"flex",flexDirection:"column",gap:"10px"},children:[a.jsx("button",{style:{background:"transparent",border:"1px solid #06b6d4",color:"#06b6d4",padding:"10px",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",textTransform:"uppercase",boxShadow:"0 0 10px rgba(6, 182, 212, 0.2)",transition:"all 0.2s"},onClick:()=>console.log("‚è∏ SIMULATION PAUSED (Visual Layer)"),children:"‚è∏ PAUSAR SIMULACI√ìN"}),a.jsx("button",{style:{background:"#06b6d4",border:"none",color:"#000",padding:"10px",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",textTransform:"uppercase",boxShadow:"0 0 15px rgba(6, 182, 212, 0.4)",transition:"all 0.2s"},onClick:i,children:"‚ö° DESPACHO INTELIGENTE"})]}),t&&a.jsxs("div",{style:{marginBottom:"20px",border:"1px solid #334155",borderRadius:"8px",padding:"10px",background:"rgba(15, 23, 42, 0.5)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[a.jsx("div",{style:{color:"#94a3b8",fontSize:"0.7rem",fontWeight:"bold",textTransform:"uppercase"},children:"üõ°Ô∏è AUTONOMOUS GUARDRAILS"}),a.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#22c55e",boxShadow:"0 0 5px #22c55e"}})]}),a.jsxs("div",{style:{marginBottom:"10px",padding:"8px",background:"rgba(239, 68, 68, 0.1)",borderLeft:"3px solid #ef4444",borderRadius:"0 4px 4px 0"},children:[a.jsx("div",{style:{color:"#ef4444",fontWeight:"bold",fontSize:"0.8rem"},children:"CEO DIRECTIVE:"}),a.jsx("div",{style:{color:"#fff",fontSize:"0.9rem",fontWeight:"bold"},children:t.strategic_alignment?.directive||"ANALYZING..."}),a.jsxs("div",{style:{color:"#94a3b8",fontSize:"0.7rem",marginTop:"4px",fontStyle:"italic"},children:['"',t.strategic_alignment?.reasoning,'"']})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"5px"},children:["finance","ops","design"].map(l=>{const s=l==="finance"?t.department_reports?.finance?.executive_summary?.score:l==="ops"?100:t.department_reports?.design_input?.design_audit?.score,f=l==="finance"?"FIN":l==="ops"?"OPS":"UX",p=l==="finance"?"üí∞":l==="ops"?"üöö":"üé®";return a.jsxs("div",{style:{background:"#020617",padding:"8px",borderRadius:"4px",textAlign:"center",border:"1px solid #1e293b"},children:[a.jsx("div",{style:{fontSize:"1.2rem"},children:p}),a.jsxs("div",{style:{fontSize:"0.6rem",fontWeight:"bold",marginTop:"2px",color:(s||0)<70?"#ef4444":"#22c55e"},children:[f," ",s||"ON","%"]})]},l)})})]}),a.jsxs("div",{style:{marginBottom:"20px",position:"relative"},children:[a.jsx("input",{type:"text",placeholder:"Buscar Orden, Unidad, Cliente [ENTER]",style:{width:"100%",background:"#1e293b",border:"1px solid #334155",borderRadius:"4px",padding:"8px 10px",color:"#fff",fontSize:"0.8rem",outline:"none"}}),a.jsx("span",{style:{position:"absolute",right:"10px",top:"8px",color:"#64748b"},children:"üîç"})]}),a.jsxs("div",{style:{flex:1,overflowY:"auto"},children:[a.jsx("div",{style:{color:"#64748b",fontSize:"0.8rem",fontWeight:"bold",marginBottom:"10px",borderBottom:"1px solid #334155",paddingBottom:"5px"},children:"UNIDADES EN L√çNEA"}),n?.services?.slice(0,10).map((l,s)=>a.jsxs("div",{onMouseEnter:()=>d(l),onMouseLeave:()=>d(null),style:{background:"rgba(255,255,255,0.03)",padding:"8px",marginBottom:"5px",borderRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",transition:"background 0.2s"},onMouseOver:f=>f.currentTarget.style.background="rgba(255,255,255,0.08)",onMouseOut:f=>f.currentTarget.style.background="rgba(255,255,255,0.03)",children:[a.jsx("div",{style:{color:"#fff",fontSize:"0.8rem"},children:l.plate||l.vehiclePlate||"TSO-000"}),a.jsx("div",{style:{color:"#39FF14",fontSize:"0.7rem"},children:l.status})]},s))]})]})}};return a.jsxs("div",{style:{width:"350px",background:"rgba(9, 9, 11, 0.95)",borderLeft:"1px solid #334155",display:"flex",flexDirection:"column",padding:"20px",zIndex:50,boxShadow:"-10px 0 40px rgba(0,0,0,0.8)",height:"100%",overflowY:"auto"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{margin:0,color:"#ef4444",fontFamily:"monospace",fontSize:"1.2rem"},children:["TESO ",e]}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#64748b"},children:"PANEL DE CONTROL INTELIGENTE"})]}),a.jsx("div",{style:{width:"30px",height:"30px",borderRadius:"50%",border:"1px solid #ea580c",display:"flex",alignItems:"center",justifyContent:"center",color:"#ea580c",cursor:"pointer"},children:"üè†"})]}),c(),o&&a.jsxs("div",{style:{position:"fixed",top:"20%",right:"370px",width:"300px",background:"rgba(9, 9, 11, 0.98)",border:"1px solid #39FF14",borderRadius:"8px",padding:"20px",zIndex:1e3,boxShadow:"0 0 20px rgba(57, 255, 20, 0.2)",backdropFilter:"blur(10px)",pointerEvents:"none"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px",borderBottom:"1px solid #333",paddingBottom:"10px"},children:[a.jsx("div",{style:{fontSize:"1.2rem"},children:"üìÑ"}),a.jsx("div",{style:{fontWeight:"bold",color:"#fff"},children:"DETALLE DE ORDEN"})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"0.8rem",color:"#ccc"},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",display:"block",fontSize:"0.7rem"},children:"ID OPERACI√ìN"}),a.jsxs("span",{style:{color:"#39FF14",fontWeight:"bold"},children:["#",o.id]})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",display:"block",fontSize:"0.7rem"},children:"ESTADO"}),a.jsx("span",{style:{color:o.status==="completed"?"#22c55e":"#f59e0b",fontWeight:"bold",textTransform:"uppercase"},children:o.status==="completed"?"FINALIZADO":o.status||"EN CURSO"})]}),a.jsxs("div",{style:{gridColumn:"span 2"},children:[a.jsx("span",{style:{color:"#64748b",display:"block",fontSize:"0.7rem"},children:"PASAJERO"}),a.jsx("span",{style:{color:"#fff",fontWeight:"bold"},children:o.paxName||o.client||"N/A"})]}),a.jsxs("div",{style:{gridColumn:"span 2"},children:[a.jsx("span",{style:{color:"#64748b",display:"block",fontSize:"0.7rem"},children:"EMPRESA"}),a.jsx("span",{style:{color:"#fff"},children:o.company||"PARTICULAR"})]}),a.jsxs("div",{style:{marginTop:"10px",paddingTop:"10px",borderTop:"1px dashed #333",gridColumn:"span 2",display:"grid",gridTemplateColumns:"1fr 1fr"},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",display:"block",fontSize:"0.7rem"},children:"CONDUCTOR"}),a.jsx("span",{style:{color:"#fff"},children:o.driverName||"PENDIENTE"})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",display:"block",fontSize:"0.7rem"},children:"VEH√çCULO"}),a.jsx("span",{style:{color:"#fff"},children:o.vehiclePlate||"TBA"})]})]}),a.jsx("div",{style:{marginTop:"10px",gridColumn:"span 2",background:"rgba(57, 255, 20, 0.05)",padding:"8px",borderRadius:"4px",border:"1px solid rgba(57, 255, 20, 0.2)"},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"0.7rem"},children:[a.jsx("span",{style:{color:"#39FF14"},children:"PIN SEGURIDAD:"}),a.jsx("span",{style:{color:"#fff",fontWeight:"bold"},children:o.pin||"A-1234"})]})})]})]})]})},Cn=({opsCommand:n,simulationData:e,planes:i})=>{const[t,r]=y.useState("FLOTA"),[o,d]=y.useState(["FLEET","JOBS","RADAR"]),[c,l]=y.useState(!1),[s,f]=y.useState(!0),p=u=>{d(S=>S.includes(u)?S.filter(b=>b!==u):[...S,u])},[h,x]=y.useState(null);return a.jsxs("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden",background:"#000"},children:[a.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1},children:[t!=="ORDENES"&&t!=="CLIENTES"&&t!=="ARTEFACTO"&&a.jsx(yn,{command:h||n,simulationData:e,activeLayers:o,planes:i}),t==="CLIENTES"&&a.jsx(It,{}),t==="ARTEFACTO"&&a.jsx(_e.Suspense,{fallback:a.jsx("div",{children:"Cargando..."}),children:a.jsx(mn,{onClose:()=>r("FLOTA")})})]}),a.jsx("div",{style:{position:"absolute",top:5,left:60,zIndex:1e3},children:a.jsx(rt,{activeTab:t,onTabChange:r})}),a.jsx(bn,{activeLayers:o,onToggle:p}),t!=="ARTEFACTO"&&a.jsxs("div",{style:{position:"absolute",top:0,right:0,height:"100%",width:s?"350px":"0px",zIndex:500,transition:"width 0.3s ease-in-out",display:"flex"},children:[a.jsx("div",{onClick:()=>f(!s),style:{position:"absolute",left:"-30px",top:"50%",width:"30px",height:"60px",background:"rgba(9, 9, 11, 0.9)",border:"1px solid #334155",borderRadius:"8px 0 0 8px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#06b6d4",zIndex:501},children:s?"‚ñ∂":"‚óÄ"}),a.jsx("div",{style:{width:"350px",height:"100%",transform:s?"translateX(0)":"translateX(350px)",transition:"transform 0.3s"},children:a.jsx(Sn,{simulationData:e,activeView:t,onDispatch:()=>x({type:"DISPATCH_WAVE",ts:Date.now()})})})]}),a.jsxs("div",{onClick:()=>l(!c),style:{position:"absolute",bottom:"20px",left:"20px",zIndex:1e3,display:"flex",alignItems:"center",gap:"10px",background:"rgba(15, 23, 42, 0.95)",border:"1px solid #06b6d4",borderRadius:"50px",padding:"10px 25px",cursor:"pointer"},children:[a.jsx("div",{style:{fontSize:"1.5rem"},children:"ü§ñ"}),c&&a.jsx("div",{style:{color:"#fff",fontSize:"0.9rem",fontWeight:"bold"},children:"CONSULTOR IA"})]}),c&&a.jsxs("div",{style:{position:"absolute",bottom:"80px",left:"20px",width:"350px",background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(10px)",border:"1px solid #334155",borderRadius:"16px",padding:"15px",zIndex:2e3},children:[a.jsx("div",{style:{color:"#94a3b8",marginBottom:"10px"},children:"Panel de Inteligencia Activo"}),["Analizar Situaci√≥n Financiera","Optimizar Rutas","Recomendar Agentes"].map(u=>a.jsxs("div",{onClick:()=>{console.log(`ü§ñ AI AGENT ACTIVATED: ${u}`);const S=document.getElementById("teso-console-log");if(S){const b=document.createElement("div");b.style.color="#06b6d4",b.innerText=`[${new Date().toLocaleTimeString()}] ü§ñ EXECUTING: ${u}...`,S.appendChild(b),S.scrollTop=S.scrollHeight}},style:{padding:"8px",borderBottom:"1px solid #333",cursor:"pointer",color:"#fff"},children:["‚Ä¢ ",u]},u))]})]})},W={provider:"NATIVE",params:{elevenKey:localStorage.getItem("ELEVEN_API_KEY")||"",voiceId:"ErXwobaYiN019PkySvjV",stability:.5,similarity_boost:.75},isMuted:!1,queue:[]};class En{constructor(){this.synth=window.speechSynthesis,this.audioContext=new(window.AudioContext||window.webkitAudioContext)}configure(e,i=null){W.provider=e,i&&(W.params.elevenKey=i,localStorage.setItem("ELEVEN_API_KEY",i))}async speak(e,i="INFO"){W.isMuted||(console.log(`üéôÔ∏è [${W.provider}] Speaking:`,e),W.provider==="ELEVEN_LABS"&&W.params.elevenKey?await this.speakElevenLabs(e):this.speakNative(e,i))}speakNative(e,i){this.synth.cancel();let t=1,r=1,o=e;(e.includes("[rapid-fire]")||e.includes("[urgent]"))&&(t=1.5),e.includes("[rushed]")&&(t=1.3),(e.includes("[slow down]")||e.includes("[deliberate]"))&&(t=.85),(e.includes("[happy]")||e.includes("[excited]"))&&(r=1.2),(e.includes("[sad]")||e.includes("[calm]"))&&(r=.9),e.includes("[nervous]")&&(t=1.2,r=1.3),e.includes("[robotic]")&&(t=.9,r=.5),o=o.replace(/\[.*?\]/g,"").trim();const d=new SpeechSynthesisUtterance(o),l=this.synth.getVoices().find(s=>s.lang.includes("es")&&(s.name.includes("Google")||s.name.includes("Premium")));l&&(d.voice=l),d.rate=t,d.pitch=r,this.synth.speak(d)}async speakElevenLabs(e){try{const i=await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${W.params.voiceId}`,{method:"POST",headers:{"Content-Type":"application/json","xi-api-key":W.params.elevenKey},body:JSON.stringify({text:e,model_id:"eleven_multilingual_v2",voice_settings:{stability:W.params.stability,similarity_boost:W.params.similarity_boost}})});if(!i.ok)throw new Error("ElevenLabs API Error");const t=await i.arrayBuffer(),r=await this.audioContext.decodeAudioData(t),o=this.audioContext.createBufferSource();o.buffer=r,o.connect(this.audioContext.destination),o.start(0)}catch(i){console.warn("‚ö†Ô∏è ElevenLabs Failed, falling back to Native:",i),this.speakNative(e,"INFO")}}stop(){this.synth.cancel()}toggleMute(){return W.isMuted=!W.isMuted,W.isMuted}formatText(e,i="neutral"){const r={angry:"[angry]",calm:"[calm]",curious:"[curious]",excited:"[excited]",happy:"[happy]",nervous:"[nervous]",sad:"[sad]",serious:"[understated]",urgent:"[rapid-fire]",announcement:"[loudly]",whisper:"[whispering]",robotic:"[robotic]",professional:"[deliberate]",sigh:"[sighs]",laugh:"[laughs]",breath:"[breathes]"}[i]||"";return r?`${r} ${e}`:e}}const He=new En,An="/documents/invoices/invoice_sier_service.pdf",wn="/documents/invoices/invoice_viajes_az.pdf",Dn="/documents/invoices/invoice_personal_soft.pdf",Un=({vehicles:n,requests:e,planes:i,initialViewMode:t="LIVE_OPS",onRowClick:r,simulationData:o,onClose:d,onHome:c,onRegenerate:l,onSimulateStress:s,onRunMacro:f})=>{const[p,h]=y.useState(o||null),[x,u]=y.useState(!1),[S,b]=y.useState(null),[I,z]=y.useState(!0),[k,Z]=y.useState(null),V=(g,E="professional")=>{if(!I)return;const v=/^\s*\[.*\]/.test(g)?g:He.formatText(g,E),w=g.includes("[urgent]")||g.includes("[angry]")||E==="urgent"?"CRITICAL":"INFO";He.speak(v,w)};y.useEffect(()=>{if(!o||!o.details)return;let g=null;o.details?.agent_analysis?.voice_script?g=o.details.agent_analysis.voice_script:o.analysis?.voice_script&&(g=o.analysis.voice_script),g&&(console.log("üó£Ô∏è AGENT SPEAKING:",g),V(g))},[o]),y.useEffect(()=>{const g={current:null},A=setInterval(async()=>{try{const v=await fetch("https://teso-api-dev.fly.dev/api/agently/alerts");if(!v.ok)return;const N=await v.json();if(N.length>0){const w=N[0];if(w.timestamp!==g.current&&(g.current=w.timestamp,console.log("üö® NEW AUTONOMOUS ALERT:",w),w.data&&w.data.analysis)){const P=`Alerta Aut√≥noma. ${w.data.analysis.message}`;V(P)}}}catch{}},3e4);return()=>clearInterval(A)},[]),y.useEffect(()=>{o&&(console.log("üîÑ DASHBOARD: Syncing with Parent Data...",o.services?.length),h(o))},[o]);const[X,ot]=y.useState(null),[Q,De]=y.useState(!1),Te=async()=>{De(!0);try{const g=await fetch("/api/strategic-cycle",{method:"POST"});if(g.ok){const E=await g.json();ot(E),E.voice_broadcast&&V(E.voice_broadcast.text)}}catch(g){console.error("CEO Brain Offline:",g)}finally{De(!1)}},at=async()=>{V("Iniciando Auditor√≠a Profunda con Agente Financiero...");try{const g=await fetch("/api/decisions/financial-audit",{method:"POST",headers:{"Content-Type":"application/json"}});if(!g.ok){const N=await g.text();throw new Error(`Server Error (${g.status}): ${N}`)}const E=await await g.json();console.log("AUDIT RESULT:",E);const A=E.score||0,v=E.verdict||"Desconocido";V(`Auditor√≠a Finalizada. Score: ${A}. Veredicto: ${v}`),alert(`‚úÖ AUDITOR√çA COMPLETADA

Score: ${A}/100
Veredicto: ${v}

(Vea el log para m√°s detalles)`)}catch(g){console.error("Audit Failed",g),V("Error cr√≠tico conectando con el Agente Financiero."),alert(`‚ùå ERROR DE CONEXI√ìN:
${g.message}

Verifique que el Backend Python est√© corriendo.`)}};y.useEffect(()=>{if(p&&!X){const g=setTimeout(Te,2e3);return()=>clearTimeout(g)}},[p]),y.useEffect(()=>{if(p)return;(async()=>{console.log("üì° CONNECTING TO TESO OPS V4..."),u(!0);try{const A=await fetch("/api/simulate/core-v4",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cars:15,avg_trips_per_day:40,days:360})});if(!A.ok)throw new Error("Ops Engine Offline");const v=await A.json();console.log("‚úÖ OPS CONNECTED:",v);const N=v.operational?.annual_trips||14400,w=v.operational?.cars||15,P=new Array(N),O=new Date;O.setDate(O.getDate()-360);for(let T=0;T<N;T++){const j=T%w+1,B=Math.floor(T/40),_=new Date(O);_.setDate(_.getDate()+B),P[T]={id:`TRIP-${T}`,date:_.toISOString(),lat:6.24+(Math.random()*.08-.04),lng:-75.58+(Math.random()*.08-.04),status:"COMPLETED",financials:{totalValue:125e3,driverPayment:82e3,netRevenue:25e3},plate:`TES-${100+j}`,driver_name:`Cond. ${j}`}}const F=P.filter((T,j)=>j%10===0).map(T=>({date:T.date,amount:25e3,type:"INCOME",description:"Comisi√≥n Teso Ops"})),Y=Array.from({length:8}).map((T,j)=>({id:`FL-${500+j}`,lat:6.24+(Math.random()*.1-.05),lng:-75.58+(Math.random()*.1-.05),heading:Math.floor(Math.random()*360),alt:8e3+Math.floor(Math.random()*5e3),spd:240+Math.floor(Math.random()*40),status:Math.random()>.3?"AIRBORNE":"LANDED",from:["MIA","BOG","CLO","JFK","MAD"][Math.floor(Math.random()*5)]}));h({...v,services:P,planes:Y,bankTransactions:F})}catch(E){console.error("‚ùå OPS ERROR:",E),b(E.message)}finally{u(!1)}})()},[]);const[ne,st]=y.useState(t),[ie,lt]=y.useState("PROGRAMACION"),[ve,dt]=y.useState(!1),[Tn,jn]=y.useState(null),[R,In]=y.useState("Today"),[Rn,Pn]=y.useState(!1),[On,Nn]=y.useState(!1),[M,ye]=y.useState({cxcDays:30,cxpFreq:15,growth:1}),[H,ct]=y.useState({status:"STABLE",minCash:0,insolvencyDay:null,runway:"‚àû"});y.useEffect(()=>{let g=[...e||[],...p?.services||[]];if(g.length===0)return;const A=(()=>{const m=new Date;return m.setHours(0,0,0,0),R==="Today"?(m.setDate(m.getDate()-1),m):R==="30D"?(m.setDate(m.getDate()-30),m):R==="90D"?(m.setDate(m.getDate()-90),m):R==="180D"?(m.setDate(m.getDate()-180),m):R==="360D"?(m.setDate(m.getDate()-360),m):new Date("2020-01-01")})();R!=="ALL"&&(g=g.filter(m=>new Date(m.date||0)>=A));const v=[],N=8e8,w=g.map(m=>new Date(m.date).getTime()),P=new Date(Math.min(...w)),O=new Date(Math.max(...w)),F=new Date(O);F.setDate(F.getDate()+parseInt(M.cxcDays)+15),g.forEach(m=>{if(m.status==="CANCELLED")return;const L=new Date(m.date);L.setDate(L.getDate()+parseInt(M.cxcDays)),v.push({date:L,amount:(m.financials?.totalValue||0)*parseFloat(M.growth),type:"INFLOW"})}),g.forEach(m=>{if(m.status==="CANCELLED")return;const L=new Date(m.date),te=L.getDate();let J=Math.ceil(te/M.cxpFreq)*M.cxpFreq;J>30&&(J=30);const le=new Date(L);te>J?(le.setMonth(le.getMonth()+1),le.setDate(M.cxpFreq)):le.setDate(J),v.push({date:le,amount:-((m.financials?.driverPayment||0)*parseFloat(M.growth)),type:"OUTFLOW"})});const Y=[{desc:"INFRAESTRUCTURA AWS",amount:25e5,day:5},{desc:"OFICINA & ADMIN",amount:45e5,day:1},{desc:"NOMINA SOPORTE (Q1)",amount:6e6,day:15},{desc:"NOMINA SOPORTE (Q2)",amount:6e6,day:30}];let T=new Date(P);for(;T<=F;){const m=T.getMonth(),L=T.getFullYear();Y.forEach(te=>{const J=new Date(L,m,te.day);J>=P&&J<=F&&v.push({date:J,amount:-te.amount,type:"FIXED_COST"})}),T.setMonth(T.getMonth()+1)}v.sort((m,L)=>m.date-L.date);let j=N,B=N,_=N,q=null;const re=[];for(let m of v)j+=m.amount,j<B&&(B=j),j>_&&(_=j),j<0&&!q&&(q=m.date.toLocaleDateString()),re.push(j);const K=re.length,C=Math.max(_-B,1e6),D=m=>90-(m-B)/C*80;let ee=`M 0 ${D(N)}`;const oe=Math.ceil(K/200);for(let m=0;m<K;m+=oe){const L=m/K*100,te=D(re[m]);ee+=` L ${L} ${te}`}ct({status:B<0?"INSOLVENT":"SUSTAINABLE",minCash:B,insolvencyDay:q,runway:q?`${Math.floor((new Date(q)-new Date)/(1e3*60*60*24))} Days`:"‚àû",graphPath:ee,duration:Math.floor(K/(g.length/v.length||1)),simDays:Math.ceil(K/(v.length/K))})},[p,M,R]),y.useEffect(()=>{t&&st(t)},[t]);const[je,Fn]=y.useState({efficiency:94,avgResponse:12,errorRate:0}),[$,ft]=y.useState({totalRevenue:0,totalCost:0,margin:0,marginPercent:0,cxcPending:0,cxpPending:0,topClients:[]}),[Mn,Ln]=y.useState(""),[kn,ht]=y.useState([]),pt=()=>{if(!H)return;gn(M,H,$).save(`TESO_CERTIFICADO_RESILIENCIA_${new Date().toISOString().slice(0,10)}.pdf`),un("Director Financiero","DOWNLOAD_STRESS_CERTIFICATE",{scenario:M,result:H.status})};y.useEffect(()=>{const E=(()=>{const C=new Date;if(R==="Today")return new Date(C.setDate(C.getDate()-1));const D=new Date;if(R==="7D")return new Date(D.setDate(D.getDate()-7));const ee=new Date;if(R==="30D")return new Date(ee.setDate(ee.getDate()-30));const oe=new Date;return R==="90D"?new Date(oe.setDate(oe.getDate()-90)):new Date("2020-01-01")})(),A=C=>C.date?new Date(C.date)>=E:!0,v=[...e||[],...p?.services||[]],N=p?.bankTransactions||[],w=R==="ALL"?v:v.filter(A),P=R==="ALL"?N:N.filter(A);let O=0,F=0,Y=0,T=0;const j={};w.forEach(C=>{const D=C.financials?.totalValue||parseFloat((C.fare||"0").replace(/[^0-9]/g,""))||0,ee=C.financials?.totalCost||D*.8,oe=C.financials?.driverPayment||D*.6;if(O+=D,F+=ee,C.status!=="CANCELLED"){Y+=D,T+=oe;const m=C.company||C.paxName||p?.clients?.find(L=>L.id===C.clientId)?.companyName||"PARTICULAR";j[m]||(j[m]=0),j[m]+=D}});const B=O-F,_=P.filter(C=>C.type==="INCOME").reduce((C,D)=>C+D.amount,0),q=Y-_;P.filter(C=>C.type==="EXPENSE"&&(C.description?.includes("N√ìMINA")||C.description?.includes("PAGO"))).reduce((C,D)=>C+Math.abs(D.amount||0),0);const re=Object.entries(j).map(([C,D])=>({name:C,volume:D,balance:D,status:D>5e6?"VIP PLATINUM":"CORPORATE"})).sort((C,D)=>D.volume-C.volume).slice(0,15);ft({totalRevenue:O,totalCost:F,margin:B,marginPercent:O>0?(B/O*100).toFixed(1):0,cxcPending:q,cxpPending:T,topClients:re});const K=re.map((C,D)=>({id:`CORP-${100+D}`,name:C.name,currentCycleServices:Math.floor(C.volume/85e3),cycleStatus:C.volume>5e6?"CUTOFF READY":"ACCUMULATING",lastInvoice:`FE-${9e3+D}`,pdf:D<3?[An,wn,Dn][D]:null}));ht(K)},[e,p,R]);const gt=g=>{if(!g)return new Date(0);if(g==="Hoy")return new Date;if(g==="Ma√±ana"){const A=new Date;return A.setDate(A.getDate()+1),A}if(g==="Pasado Ma√±ana"){const A=new Date;return A.setDate(A.getDate()+2),A}const E=new Date(g);return isNaN(E.getTime())?(console.warn("Invalid Date encountered:",g),new Date(0)):E};(()=>{const g=[...e||[],...p?.services||[]];if(R==="ALL")return g.length;const A=(()=>{const v=new Date;return v.setHours(0,0,0,0),R==="Today"?(v.setDate(v.getDate()-1),v):R==="7D"?(v.setDate(v.getDate()-7),v):R==="30D"?(v.setDate(v.getDate()-30),v):R==="90D"?(v.setDate(v.getDate()-90),v):R==="180D"?(v.setDate(v.getDate()-180),v):new Date("2020-01-01")})();return g.filter(v=>gt(v.date)>=A).length})();const[zn,Hn]=y.useState(null),ut=()=>!X&&!Q?null:a.jsxs("div",{style:{margin:"20px",background:"linear-gradient(135deg, #1e1b4b 0%, #312e81 100%)",border:"1px solid #6366f1",borderRadius:"8px",padding:"20px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.5)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[a.jsx("div",{style:{fontSize:"2rem",background:"#fff",borderRadius:"50%",width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center"},children:"üëî"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:"0.8rem",color:"#a5b4fc",fontWeight:"bold"},children:"VORTEX STRATEGIC ORCHESTRATOR"}),a.jsx("div",{style:{fontSize:"1.2rem",color:"#fff",fontWeight:"900"},children:Q?"ANALIZANDO ESTRATEGIA GLOBAL...":"DIRECTIVA EJECUTIVA VIGENTE"})]})]}),a.jsx("div",{children:a.jsx("button",{onClick:Te,disabled:Q,style:{background:Q?"#4338ca":"#4f46e5",color:"#fff",border:"none",padding:"10px 20px",borderRadius:"6px",fontWeight:"bold",cursor:Q?"wait":"pointer"},children:Q?"‚è≥ CALCULANDO...":"üîÑ RE-EVALUAR ESTRATEGIA"})})]}),X&&!Q&&a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"20px"},children:[a.jsxs("div",{style:{background:"rgba(0,0,0,0.3)",padding:"15px",borderRadius:"6px"},children:[a.jsx("div",{style:{color:"#818cf8",fontSize:"0.75rem",marginBottom:"5px"},children:"DECISI√ìN DEL CEO"}),a.jsx("div",{style:{color:"#fff",fontSize:"1.4rem",fontWeight:"bold",marginBottom:"10px"},children:X.strategic_alignment.directive.replace(/_/g," ")}),a.jsxs("div",{style:{color:"#c7d2fe",fontSize:"0.9rem",fontStyle:"italic"},children:['"',X.strategic_alignment.reasoning,'"']})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[a.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",borderLeft:"3px solid #34d399"},children:[a.jsx("div",{style:{fontSize:"0.7rem",color:"#aaa"},children:"CFO (FINANZAS)"}),a.jsxs("div",{style:{fontWeight:"bold",color:"#fff"},children:["Score: ",X.department_reports?.finance?.executive_summary?.score||0,"/100"]})]}),a.jsxs("div",{style:{background:"rgba(0,0,0,0.2)",padding:"10px",borderRadius:"4px",borderLeft:"3px solid #fbbf24"},children:[a.jsx("div",{style:{fontSize:"0.7rem",color:"#aaa"},children:"COO (LOG√çSTICA)"}),a.jsxs("div",{style:{fontWeight:"bold",color:"#fff"},children:["Status: ",X.department_reports?.operations?.dispatch_summary?.status||"N/A"]})]})]})]})]}),[xt,vt]=y.useState({activeOrderId:null,stepIndex:-1,nodes:[{id:"MARKET",icon:"üì°",label:"MARKET SENSOR",role:"Demand & IO Handler",status:"SCANNING",load:30,logs:["Listening..."]},{id:"PRICING",icon:"üß†",label:"PRICING CORE",role:"Dynamic Calc / Fixed Routes",status:"IDLE",load:0,logs:[]},{id:"FINANCE",icon:"üõ°Ô∏è",label:"PAYMENT GUARDIAN",role:"Pre-Service Fund Capture",status:"IDLE",load:0,logs:[]},{id:"COMPLIANCE",icon:"‚öñÔ∏è",label:"LEGAL CHECK",role:"RNT/SOAT Validation",status:"IDLE",load:0,logs:[]},{id:"DISPATCH",icon:"üöÄ",label:"OPS SENTINEL",role:"Assignment & Routing",status:"IDLE",load:0,logs:[]}]}),[yt,Ie]=y.useState([{time:"10:42:01",msg:"System stable. Orchestrator: ONLINE."}]);y.useEffect(()=>{const g=setInterval(()=>{vt(E=>{let{activeOrderId:A,stepIndex:v,nodes:N}=E;const w=[...N];if(A===null&&Math.random()>.7){const P=`ORD-${Math.floor(Math.random()*9e3)+1e3}`;return{...E,activeOrderId:P,stepIndex:0,nodes:w.map((O,F)=>F===0?{...O,status:"PROCESSING",load:80,logs:[`New Request: ${P}`]}:O)}}if(A){const P=w[v];if(P.load>0)w[v]={...P,load:Math.max(0,P.load-25)};else{w[v]={...P,status:"DONE",logs:["Completed."]};const O=v+1;if(O<w.length){const F=w[O],Y=[["Calculating Tariff..."],["Capturing Funds..."],["Verifying Driver Docs..."],["Dispatching Unit..."]],T=["üì° MARKET -> üß† PRICING: Request Data { dist: 12km, pax: 'VIP' }","üß† PRICING -> üõ°Ô∏è FINANCE: Quote Locked $45.000 (Pre-Paid).","üõ°Ô∏è FINANCE -> ‚öñÔ∏è COMPLIANCE: Funds Secured (Tx#99). Verify Asset.","‚öñÔ∏è COMPLIANCE -> üöÄ DISPATCH: Legal Check Passed. Auth to Dispatch."];return T[v]&&Ie(j=>[{time:new Date().toLocaleTimeString("es-CO",{hour12:!1}),msg:T[v],type:"HANDSHAKE"},...j.slice(0,9)]),w[O]={...F,status:"WORKING",load:100,logs:Y[v]||["Processing..."]},{...E,stepIndex:O,nodes:w}}else return Ie(F=>[{time:new Date().toLocaleTimeString("es-CO",{hour12:!1}),msg:`‚úÖ ORCHESTRATION COMPLETE: ${A} Dispatched w/ Zero Friction.`},...F.slice(0,8)]),{...E,activeOrderId:null,stepIndex:-1,nodes:w.map(F=>({...F,status:"IDLE",load:0,logs:[]}))}}}return A||(w[0]={...w[0],status:"SCANNING",load:30+Math.random()*10}),{...E,nodes:w}})},800);return()=>clearInterval(g)},[]);const se=g=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}).format(g);return a.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:ne==="LIVE_OPS"?"transparent":"var(--color-bg-app)",backdropFilter:ne==="LIVE_OPS"?"none":"blur(20px)",boxShadow:ne==="LIVE_OPS"?"none":"0 0 50px rgba(0,0,0,0.5)",border:ne==="LIVE_OPS"?"none":"1px solid var(--color-border-subtle)",pointerEvents:"auto",color:"var(--color-text-primary)",zIndex:100,padding:ne==="LIVE_OPS"?0:"var(--spacing-xl)",display:"flex",flexDirection:"column",fontFamily:"var(--font-main)"},children:ne==="LIVE_OPS"?a.jsx("div",{style:{flex:1,position:"relative",overflow:"hidden"},children:a.jsx(Cn,{opsCommand:k,simulationData:{...p,services:e||p?.services,vehicles:n||p?.vehicles},planes:i})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",pointerEvents:"auto"},children:[a.jsx(rt,{activeTab:ie,onTabChange:lt,tabs:[{id:"PROGRAMACION",label:"AGENDA",icon:"üìÖ"},{id:"FINANCE",label:"FINANZAS",icon:"üí∞"},{id:"CLIENTS",label:"CLIENTES",icon:"üè¢"},{id:"MARKETING",label:"MERCADO",icon:"üì¢"},{id:"WAR_ROOM",label:"WAR ROOM",icon:"‚öîÔ∏è"}]}),a.jsxs("div",{style:{display:"flex",gap:"10px"},children:[a.jsx(de,{label:ve?"üîì EXIT AUDIT":"üîí AUDIT MODE",active:ve,onClick:()=>dt(!ve),variant:"secondary"}),a.jsx(de,{label:"‚úñ CLOSE",onClick:d,variant:"danger"})]})]}),a.jsx("div",{style:{pointerEvents:"auto"},children:a.jsx(ut,{})}),a.jsxs("div",{style:{flex:1,overflowY:"auto",paddingRight:"10px",pointerEvents:"auto"},children:[ie==="PROGRAMACION"&&a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:[a.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[a.jsx("h3",{children:"METRICAS OPERATIVAS"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[a.jsxs("div",{children:[a.jsx("div",{className:"label",children:"Eficiencia"}),a.jsxs("div",{className:"value-lg",style:{color:"var(--color-kpi-positive)"},children:[je.efficiency,"%"]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"label",children:"Conflictos"}),a.jsx("div",{className:"value-lg",style:{color:je.errorRate>0?"var(--color-kpi-danger)":"var(--color-text-secondary)"},children:p?.conflicts?.cancellations||0})]})]})]}),a.jsxs("div",{className:"glass-panel",style:{padding:"20px",gridColumn:"span 2"},children:[a.jsx("h3",{children:"ORQUESTADOR DE IA (WORKFORCE)"}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px"},children:xt.nodes.map((g,E)=>a.jsxs("div",{style:{textAlign:"center",opacity:g.status==="IDLE"?.4:1,width:"18%"},children:[a.jsx("div",{style:{fontSize:"2rem",marginBottom:"10px",filter:g.status==="WORKING"?"drop-shadow(0 0 8px cyan)":"none"},children:g.icon}),a.jsx("div",{style:{fontSize:"0.8rem",fontWeight:"bold",color:"#fff"},children:g.label}),a.jsx("div",{style:{fontSize:"0.7rem",color:"#aaa",height:"15px"},children:g.status==="WORKING"?g.logs[0]:g.status}),a.jsx("div",{style:{height:"4px",background:"#333",marginTop:"5px",borderRadius:"2px"},children:a.jsx("div",{style:{width:`${g.load}%`,height:"100%",background:g.id==="DISPATCH"?"#10b981":"#06b6d4",transition:"width 0.2s"}})})]},g.id))}),a.jsx("div",{style:{marginTop:"20px",background:"#000",padding:"10px",borderRadius:"4px",height:"100px",overflowY:"auto",fontFamily:"monospace",fontSize:"0.8rem",color:"#39FF14"},children:yt.map((g,E)=>a.jsxs("div",{children:["[",g.time,"] ",g.msg]},E))})]})]}),ie==="FINANCE"&&a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 3fr",gap:"20px"},children:[a.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[a.jsxs("h2",{children:["CAJA: ",se($.margin)]}),a.jsxs("div",{style:{marginTop:"20px",display:"flex",flexDirection:"column",gap:"15px"},children:[a.jsxs("div",{children:[a.jsx("div",{className:"label",children:"Ingresos Totales"}),a.jsx("div",{className:"value",children:se($.totalRevenue)})]}),a.jsxs("div",{children:[a.jsx("div",{className:"label",children:"Costos Operativos"}),a.jsx("div",{className:"value",style:{color:"#ef4444"},children:se($.totalCost)})]}),a.jsxs("div",{children:[a.jsx("div",{className:"label",children:"Margen Neto"}),a.jsxs("div",{className:"value",style:{color:"#39FF14"},children:[$.marginPercent,"%"]})]}),a.jsx("hr",{style:{borderColor:"#333"}}),a.jsxs("div",{children:[a.jsx("div",{className:"label",children:"CxC Pendiente"}),a.jsx("div",{className:"value",style:{color:"#f59e0b"},children:se($.cxcPending)})]}),a.jsxs("div",{children:[a.jsx("div",{className:"label",children:"CxP Drivers"}),a.jsx("div",{className:"value",style:{color:"#6366f1"},children:se($.cxpPending)})]})]}),a.jsx("div",{style:{marginTop:"30px"},children:a.jsx(de,{label:"üîç AUDITAR CAJA",onClick:at})})]}),a.jsxs("div",{className:"glass-panel",style:{padding:"20px"},children:[a.jsx("h3",{children:"PROYECCI√ìN DE FLUJO DE CAJA (STRESS TEST)"}),a.jsxs("div",{style:{height:"300px",display:"flex",alignItems:"flex-end",gap:"2px",paddingBottom:"20px",borderBottom:"1px solid #333",position:"relative"},children:[H&&H.graphPath&&a.jsxs("svg",{width:"100%",height:"100%",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[a.jsx("line",{x1:"0",y1:"50",x2:"100",y2:"50",stroke:"#333",strokeDasharray:"2",strokeWidth:"0.5"}),a.jsx("path",{d:H.graphPath,fill:"none",stroke:H.status==="INSOLVENT"?"#ef4444":"#39FF14",strokeWidth:"1.5",vectorEffect:"non-scaling-stroke"}),a.jsx("path",{d:`${H.graphPath} L 100 100 L 0 100 Z`,fill:H.status==="INSOLVENT"?"rgba(239, 68, 68, 0.1)":"rgba(57, 255, 20, 0.1)",stroke:"none"})]}),a.jsxs("div",{style:{position:"absolute",top:10,right:10,textAlign:"right"},children:[a.jsx("div",{style:{fontSize:"0.8rem",color:"#aaa"},children:"RUNWAY ACTUAL"}),a.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:H?.runway==="‚àû"?"#39FF14":"#ef4444"},children:H?.runway})]})]}),a.jsxs("p",{style:{fontSize:"0.8rem",color:"#666",marginTop:"10px"},children:["* Proyecci√≥n basada en ",$.cxcPending>0?"ciclo de cobro actual":"datos hist√≥ricos","."]})]})]}),ie==="WAR_ROOM"&&a.jsxs("div",{className:"glass-panel",style:{padding:"30px",maxWidth:"800px",margin:"0 auto"},children:[a.jsx("h2",{style:{color:"#ef4444"},children:"‚öîÔ∏è COMMAND CENTER (WAR ROOM) ‚öîÔ∏è"}),a.jsx("p",{children:"Ajuste par√°metros globales de simulaci√≥n. Use con precauci√≥n."}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"30px",marginTop:"30px"},children:[a.jsxs("div",{children:[a.jsx("h4",{children:"ESCENARIO DE ESTR√âS"}),a.jsxs("div",{style:{marginBottom:"15px"},children:[a.jsx("label",{children:"D√≠as de Cartera (CxC)"}),a.jsx("input",{type:"range",min:"0",max:"120",value:M.cxcDays,onChange:g=>ye({...M,cxcDays:g.target.value}),style:{width:"100%"}}),a.jsxs("div",{style:{textAlign:"right",color:"#39FF14"},children:[M.cxcDays," D√≠as"]})]}),a.jsxs("div",{style:{marginBottom:"15px"},children:[a.jsx("label",{children:"Frecuencia N√≥mina"}),a.jsxs("select",{value:M.cxpFreq,onChange:g=>ye({...M,cxpFreq:parseInt(g.target.value)}),style:{width:"100%",background:"#000",color:"#fff",padding:"5px"},children:[a.jsx("option",{value:15,children:"Quincenal (15)"}),a.jsx("option",{value:30,children:"Mensual (30)"}),a.jsx("option",{value:7,children:"Semanal (7)"})]})]})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",justifyContent:"center"},children:[a.jsx(de,{label:"üö® SIMULAR QUIEBRA (STRESS TEST)",variant:"danger",onClick:()=>{ye({cxcDays:90,cxpFreq:7,growth:.5}),alert("Simulando escenario 'Perfect Storm'...")}}),a.jsx(de,{label:"üìÑ DESCARGAR REPORTE PDF",variant:"primary",onClick:pt})]})]})]}),["CLIENTS","MARKETING"].includes(ie)&&a.jsxs("div",{style:{textAlign:"center",padding:"50px",color:"#666"},children:[a.jsxs("h1",{children:["M√ìDULO ",ie]}),a.jsx("p",{children:"Datos en vivo conectando con API v4..."})]})]})]})})};export{Un as default};
